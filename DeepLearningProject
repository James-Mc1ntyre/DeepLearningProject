{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Motor Imagery Deep Learning project <br>\n",
    "By: James McIntyre and John McLinden"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 228,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[]\n"
     ]
    }
   ],
   "source": [
    "# imports\n",
    "import os\n",
    "import numpy as np\n",
    "import tensorflow as tf\n",
    "import tensorflow_probability as tfp\n",
    "from keras.callbacks import ModelCheckpoint, EarlyStopping\n",
    "from keras import layers, losses\n",
    "import mne \n",
    "mne.utils.set_config('MNE_USE_CUDA', 'true')  \n",
    "import matplotlib.pyplot as plt\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import minmax_scale\n",
    "physical_devices = tf.config.experimental.list_physical_devices('GPU')\n",
    "print(physical_devices)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load data\n",
    "Load saved epochs and labels from preprocessing step"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 229,
   "metadata": {},
   "outputs": [],
   "source": [
    "filepath = os.getcwd()\n",
    "\n",
    "data = np.load(filepath + '\\\\RecordedProjectData\\\\preprocessedOnlineDataset_EpochsAndLabels.npz')\n",
    "x_train = data['training_epochs']\n",
    "y_train = data['training_labels']\n",
    "x_test = data['testing_epochs']\n",
    "y_test = data['testing_labels']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Create one-hot encoding for labels"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 230,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Usign their one-hot encoding function\n",
    "def to_one_hot(y, by_sub=False):\n",
    "    if by_sub:\n",
    "        new_array = np.array([\"nan\" for nan in range(len(y))])\n",
    "        for index, label in enumerate(y):\n",
    "            new_array[index] = ''.join([i for i in label if not i.isdigit()])\n",
    "    else:\n",
    "        new_array = y.copy()\n",
    "    total_labels = np.unique(new_array)\n",
    "    mapping = {}\n",
    "    for x in range(len(total_labels)):\n",
    "        mapping[total_labels[x]] = x\n",
    "    for x in range(len(new_array)):\n",
    "        new_array[x] = mapping[new_array[x]]\n",
    "\n",
    "    return tf.keras.utils.to_categorical(new_array)\n",
    "        \n",
    "#Transform y to one-hot-encoding\n",
    "# enc = onehot\n",
    "y_test_valid_OH = to_one_hot(y_test)\n",
    "y_train_OH = to_one_hot(y_train)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Reshape data then apply MinMax scaling, in the same way that the CNN was trained"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 231,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Reshape for scaling\n",
    "x_train_reshapedForScaling = x_train.reshape(x_train.shape[0], x_train.shape[1] * x_train.shape[2])\n",
    "x_test_valid_reshapedForScaling = x_test.reshape(x_test.shape[0], x_test.shape[1] * x_test.shape[2])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 232,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Scale train and test separately\n",
    "x_train_scaled = minmax_scale(x_train_reshapedForScaling, axis=2)\n",
    "x_test_valid_scaled = minmax_scale(x_test_valid_reshapedForScaling, axis=2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 233,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Reshape after scaling, reshape training data after SMOTE\n",
    "x_test_valid_reshaped = x_test_valid_scaled.reshape(x_test_valid_scaled.shape[0], int(x_test_valid_scaled.shape[1]/2),2).astype(np.float64)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Create Val/Test split from test dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 234,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Create Validation/test\n",
    "x_valid_reshaped, x_test_reshaped, y_valid_OH, y_test_OH = train_test_split(x_test_valid_reshaped,\n",
    "                                                    y_test_valid_OH,\n",
    "                                                    stratify=y_test_valid_OH,\n",
    "                                                    test_size=0.50,\n",
    "                                                    random_state=42)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Apply SMOTE for data augmentation<br>\n",
    "Only apply to training set <br>\n",
    "Does not apply for online dataset, only for the limited recorded dataset.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 235,
   "metadata": {},
   "outputs": [],
   "source": [
    "# # smote\n",
    "# from imblearn.over_sampling import SMOTE\n",
    "# sm = SMOTE(random_state=42)\n",
    "# x_train_smote, y_train_OH_smote = sm.fit_resample(x_train_scaled, y_train_OH)\n",
    "# print('classes count')\n",
    "# print ('before oversampling = {}'.format(y_train_OH.sum(axis=0)))\n",
    "# print ('after oversampling = {}'.format(y_train_OH_smote.sum(axis=0)))\n",
    "\n",
    "# no smote\n",
    "x_train_smote, y_train_OH_smote = x_train_scaled, y_train_OH"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Reshape training data after SMOTE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 236,
   "metadata": {},
   "outputs": [],
   "source": [
    "x_train_reshaped = x_train_smote.reshape(x_train_smote.shape[0], int(x_train_smote.shape[1]/2),2).astype(np.float64)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Train CNN architecture on new dataset"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Set up and train a CNN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 237,
   "metadata": {},
   "outputs": [],
   "source": [
    "class HopefullNet(tf.keras.Model):\n",
    "    \"\"\"\n",
    "    Original HopeFullNet\n",
    "    \"\"\"\n",
    "    def __init__(self, inp_shape = (640,2)):\n",
    "        super(HopefullNet, self).__init__()\n",
    "        self.inp_shape = inp_shape\n",
    "\n",
    "        self.kernel_size_0 = 20\n",
    "        self.kernel_size_1 = 6\n",
    "        self.drop_rate = 0.5\n",
    "\n",
    "        self.conv1 = tf.keras.layers.Conv1D(filters=32,\n",
    "                                            kernel_size=self.kernel_size_0,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"same\",\n",
    "                                            input_shape=self.inp_shape)\n",
    "        self.batch_n_1 = tf.keras.layers.BatchNormalization()\n",
    "        self.conv2 = tf.keras.layers.Conv1D(filters=32,\n",
    "                                            kernel_size=self.kernel_size_0,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"valid\")\n",
    "        self.batch_n_2 = tf.keras.layers.BatchNormalization()\n",
    "        self.spatial_drop_1 = tf.keras.layers.SpatialDropout1D(self.drop_rate)\n",
    "        self.conv3 = tf.keras.layers.Conv1D(filters=32,\n",
    "                                            kernel_size=self.kernel_size_1,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"valid\")\n",
    "        self.avg_pool1 = tf.keras.layers.AvgPool1D(pool_size=2)\n",
    "        self.conv4 = tf.keras.layers.Conv1D(filters=32,\n",
    "                                            kernel_size=self.kernel_size_1,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"valid\")\n",
    "        self.spatial_drop_2 = tf.keras.layers.SpatialDropout1D(self.drop_rate)\n",
    "        self.flat = tf.keras.layers.Flatten()\n",
    "        self.dense1 = tf.keras.layers.Dense(296, activation='relu')\n",
    "        self.dropout1 = tf.keras.layers.Dropout(self.drop_rate)\n",
    "        self.dense2 = tf.keras.layers.Dense(148, activation='relu')\n",
    "        self.dropout2 = tf.keras.layers.Dropout(self.drop_rate)\n",
    "        self.dense3 = tf.keras.layers.Dense(74, activation='relu')\n",
    "        self.dropout3 = tf.keras.layers.Dropout(self.drop_rate)\n",
    "        self.out = tf.keras.layers.Dense(4, activation='softmax')\n",
    "\n",
    "    def call(self, input_tensor):\n",
    "        conv1 = self.conv1(input_tensor)\n",
    "        batch_n_1 = self.batch_n_1(conv1)\n",
    "        conv2 = self.conv2(batch_n_1)\n",
    "        batch_n_2 = self.batch_n_2(conv2)\n",
    "        spatial_drop_1 = self.spatial_drop_1(batch_n_2)\n",
    "        conv3 = self.conv3(spatial_drop_1)\n",
    "        avg_pool1 = self.avg_pool1(conv3)\n",
    "        conv4 = self.conv4(avg_pool1)\n",
    "        spatial_drop_2 = self.spatial_drop_2(conv4)\n",
    "        flat = self.flat(spatial_drop_2)\n",
    "        dense1 = self.dense1(flat)\n",
    "        dropout1 = self.dropout1(dense1)\n",
    "        dense2 = self.dense2(dropout1)\n",
    "        dropout2 = self.dropout2(dense2)\n",
    "        return self.out(dropout2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Compile model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 238,
   "metadata": {},
   "outputs": [],
   "source": [
    "learning_rate = 1e-4\n",
    "\n",
    "loss = tf.keras.losses.categorical_crossentropy\n",
    "optimizer = tf.keras.optimizers.Adam(learning_rate=learning_rate)\n",
    "model = HopefullNet()\n",
    "\n",
    "model.compile(loss=loss, optimizer=optimizer, metrics=['accuracy'])\n",
    "\n",
    "# Where to save model\n",
    "modelPath = filepath + r'\\models\\OnlineDatasetTraainedModel.h5'\n",
    "\n",
    "# build callback list\n",
    "checkpoint = ModelCheckpoint( # set model saving checkpoints\n",
    "    modelPath, # set path to save model weights\n",
    "    monitor='val_loss', # set monitor metrics\n",
    "    verbose=1, # set training verbosity\n",
    "    save_best_only=True, # set if want to save only best weights\n",
    "    save_weights_only=True, # set if you want to save only model weights\n",
    "    mode='auto', # set if save min or max in metrics\n",
    "    save_freq='epoch' # interval between checkpoints\n",
    "    )\n",
    "\n",
    "earlystopping = EarlyStopping(\n",
    "    monitor='val_loss', # set monitor metrics\n",
    "    min_delta=0.00001, # set minimum metrics delta\n",
    "    patience=4, # number of epochs to stop training\n",
    "    restore_best_weights=True, # set if use best weights or last weights\n",
    "    )\n",
    "callbacksList = [checkpoint, earlystopping] # build callbacks list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 239,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.9207 - accuracy: 0.2420\n",
      "Epoch 1: val_loss improved from inf to 1.38570, saving model to C:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\localTraainedModel.h5\n",
      "78/78 [==============================] - 7s 77ms/step - loss: 1.9207 - accuracy: 0.2420 - val_loss: 1.3857 - val_accuracy: 0.2668\n",
      "Epoch 2/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.5637 - accuracy: 0.2111\n",
      "Epoch 2: val_loss did not improve from 1.38570\n",
      "78/78 [==============================] - 6s 72ms/step - loss: 1.5637 - accuracy: 0.2111 - val_loss: 1.3864 - val_accuracy: 0.2789\n",
      "Epoch 3/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.4570 - accuracy: 0.2728\n",
      "Epoch 3: val_loss did not improve from 1.38570\n",
      "78/78 [==============================] - 5s 67ms/step - loss: 1.4570 - accuracy: 0.2728 - val_loss: 1.3867 - val_accuracy: 0.2756\n",
      "Epoch 4/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.4432 - accuracy: 0.2600\n",
      "Epoch 4: val_loss did not improve from 1.38570\n",
      "78/78 [==============================] - 5s 66ms/step - loss: 1.4432 - accuracy: 0.2600 - val_loss: 1.3866 - val_accuracy: 0.2613\n",
      "Epoch 5/100\n",
      "77/78 [============================>.] - ETA: 0s - loss: 1.4514 - accuracy: 0.2571\n",
      "Epoch 5: val_loss did not improve from 1.38570\n",
      "78/78 [==============================] - 5s 67ms/step - loss: 1.4507 - accuracy: 0.2574 - val_loss: 1.3858 - val_accuracy: 0.2789\n"
     ]
    }
   ],
   "source": [
    "hist = model.fit(x_train_reshaped, y_train_OH_smote, epochs=100, batch_size=10,\n",
    "                validation_data=(x_valid_reshaped, y_valid_OH), callbacks=callbacksList)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 240,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x18943d91f70>"
      ]
     },
     "execution_count": 240,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAagAAAEWCAYAAAAzcgPFAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8rg+JYAAAACXBIWXMAAAsTAAALEwEAmpwYAABDUklEQVR4nO3dd3hUZfbA8e9JISH0ZkIVFBIIhC62RV0ssDbsgB1RFGyIDX8WFKwgtrUhSnFRlEUUxXVZVBTdVVERSECkSxFC7yXt/P54Z5wQUmYgkzsh5/M882TOzJ17T+7M5OS9973vK6qKMcYYE2mivE7AGGOMKYwVKGOMMRHJCpQxxpiIZAXKGGNMRIrxOgFjjClrP//88zExMTFvAm2wf9S9lgdk5OTk3NipU6eN+Z+wAmWMqXBiYmLeTEpKalWvXr1tUVFR1pXZQ3l5ebJp06bUDRs2vAlcmP85+8/BGFMRtalXr95OK07ei4qK0nr16u3AtWYPfs6DfIwxxmtRVpwih++9OKQeWYEyxhgTkaxAGWPMUSw7O9vrFA6bFShjjPHIWWeddXzr1q1bNW/evPWzzz5bF2DKlCnVU1NTW6WkpKSefPLJyQA7duyIuuyyy5omJyenJicnp44fP74mQEJCQgf/usaNG1fr0ksvbQpw6aWXNr3yyiubtG3btuWAAQMazZo1K6F9+/YtW7VqldqhQ4eW8+fPjwPIycmhf//+jVq0aNE6OTk59Yknnjjm448/rnbWWWcd71/vhx9+WP3ss88+Hg9YLz5jTIV2ww00zsggoTTX2aYNe8eOZU1Jy73zzjurEhMTc3fv3i0dOnRI7dWr1/bbbrut6VdffbW4ZcuWWZmZmdEAQ4YMqV+9evXcJUuWLALYtGlTdEnrXr9+faW5c+cujomJYevWrVE//vjj4tjYWD766KNq9913X6MZM2YsHzVqVL3Vq1dXWrRo0cLY2FgyMzOj69Wrl3vnnXc2+eOPP2IaNGiQM3bs2Dp9+/bdfOR7JXRWoIwxxiPPPPNM4qeffloTYMOGDbEvvfRSvS5duuxq2bJlFkBiYmIuwOzZs6u/9957K/yvq1evXm5J677kkku2xcS4P/Fbt26N7tWrV7NVq1bFi4hmZ2cLwJdffln9lltu2RQbG0v+7V1xxRVbxowZU/vWW2/dMnfu3KpTp05dWaq/eJCsQBljKrRgWjrhMH369Gpff/11tZ9++mlxtWrV8rp06ZLSoUOHvb/99lt8sOsQkT/v79u3T/I/V7Vq1Tz//fvvv7/h6aefvmvmzJnLf/vtt0rdunVLKW69AwYM2HLeeec1j4+P1wsuuGCbv4CVNTsHZYwxHti+fXt0jRo1cqtVq5b3yy+/xM+fP7/K/v37o+bMmVNt8eLFlQD8h/hOP/30nc8///wx/tf6D/HVqVMne+7cufG5ublMmzatVlHb2rlzZ3SjRo2yAEaPHl3X//iZZ565c/To0XX9HSn822vatGl2YmJi9qhRo+r379/fk8N7YAXKGGM8cemll+7IycmR4447rvW9997bsF27dnuOOeaYnJdeemnVxRdf3DwlJSX14osvPg7gqaeeWr99+/boFi1atE5JSUn917/+VQ3gscceW9ezZ8/mHTt2bJmYmFhkd737779/w6OPPtqoVatWqTk5OX8+ftddd21q1KhRVsuWLVunpKSkvvXWW7X9z/Xu3XtL/fr1szp27Lg/jLuhWGITFhpjKpr58+evateunWctg/Lg2muvbdKhQ4e9d911V5nsp/nz59dt165d0/yP2TkoY4wxB2ndunWrypUr540ePdqT83N+VqCMMcYcZOHChb96nQPYOShjjDERygqUMcaYiGQFyhhjTESyAmWMMSYiWYEyxhgTkaxAGWNMOZB/5PKKwgqUMcaYoJXl/FJWoIwxFV6XLqS89BJ1AA4cQLp0IeXVV6kNsGsXUV26kDJmDLUAtmwhuksXUiZMoCbA+vXEdOlCyrvvUgNg9ergri8dOHBgw6eeeqqePx48eHCD++67r/7JJ5+cnJqa2io5OTl14sSJNYNZ144dO6KKet3LL79cJzk5OTUlJSX1oosuagawZs2amLPPPvv4lJSU1JSUlNSZM2dW+e233yq1aNGitf91jzzySOLgwYMbuP3TJeWGG25o3KZNm1aPP/544rvvvlujbdu2LVu1apV6yimnJK9ZsybGn0fBeateeOGFOjfccENj/3pHjRpVt1+/fn/GxbELdY0xxgNXXXXV1kGDBjV54IEHNgFMmzat1owZM5YMGTIks3bt2nnr16+POfHEE1teeeWV26Oiim9LJCQk5H366afLCr5u7ty58c8++2z97777bnH9+vVz/IPB3nLLLU26du2665FHHlmek5PDjh07ojdv3lzsHFNZWVmSkZHxK7jBanv37r04KiqK5557ru6wYcOSxowZs7aweasqVaqkbdq0qX/gwIG1cXFxOnHixLqjR4/+PZh9ZAXKGFPhzZnDb/77cXFo/rhaNfLyx3XqkJs/rl+fnPxxkyYERmMtxqmnnrpvy5YtMatWrYpdv359TI0aNXIbN26cc9NNNzX+/vvvq0ZFRbFx48ZKa9eujWnSpEmx68zLy5NBgwY1Kvi6GTNmVL/gggu21a9fPwcC8z3973//qzZlypSVADExMdSpUye3pALVp0+frf77K1eurHTRRRc12rRpU2xWVlZU48aND0DR81adeuqpu95///0aaWlp+7Ozs6VLly77gtlHVqCMMcYjF1544baJEyfW2rBhQ+wll1yydfTo0bW3bNkSk56e/mtcXJw2bNgwbd++fSWeijnc1+UXExOjeXl/TiHF/v37D3p9tWrV/nzytttua3LnnXduuOqqq3ZMnz692rBhwxoUt+7+/ftvfuKJJ5KSk5P3X3311UEPPmvnoIwxxiNXX3311g8++KD29OnTa11zzTXbduzYEV23bt3suLg4/eSTT6r98ccflYJZT1Gv6969+85PPvmk1oYNG6IhMN/TqaeeumvkyJH1AHJyctiyZUt0o0aNcrZu3RqzYcOG6H379smMGTNqFLW9Xbt2RTdp0iQbYPz48XX8jxc1b1W3bt32rF+/vtKHH35Yp1+/flsPXWPhrEAZY4xHOnfuvH/Pnj1RiYmJWccee2z2jTfeuHX+/PlVkpOTUydMmFCnWbNmQc3FVNTrOnfuvP/uu+9e37Vr15YpKSmpAwcObAzw2muvrf7666+rJScnp7Zp0yb1l19+iY+Li9O77757/QknnNCqa9euyc2bNy9y2w8++OAfffr0Ob5169at6tSp8+fhx6LmrQK46KKLtnXu3Hl3MNPV+4VtPigRGQucD2xU1TaFPC/Ai8C5wF7gelWdG5ZkjDEmH5sPquz99a9/bT5o0KDMnj177irs+cLmgwpnC2o80KOY5/8GtPDd+gOvhTEXY4wxHti8eXN006ZN28THx+cVVZyKErZOEqo6W0SaFrNIT+BtdU2470WkpojUV9X14crJGGPKszlz5lS+9tprm+V/rFKlSnkLFixY7FVOJalbt27uqlWrMg7ntV724msI5J+tca3vsUMKlIj0x7WyADolJCSEPztjzFFr6tSp5ObmHut1HqGKiYnh3XffPeTxuXPndirptXl5eXTu3PnnsCQWJuWim7mqvgG8AVClShXds2ePxxkZY8qzX3/9lVatWnmdRpn6+eef80peKrJ42YtvHZB/uItGvseMMcYYTwvUx8C14pwE7LDzT8YYY/zCdohPRCYBZwB1RWQtMBSIBVDV14F/4bqYL8N1M+8brlyMMSbSVK1ald27d3udRkQLZy++PiU8r8Ct4dq+McaY8s1GkjDGGA+pKvfeey9t2rQhLS2N999/H4D169dz2mmn0b59e9q0acM333xDbm4u119//Z/LPv/88x5nH17lohefMcaEzaBBMG9e6a6zfXt44YWgFp06dSrz5s1j/vz5bN68mRNOOIHTTjuNd999l+7du/Pggw+Sm5vL3r17mTdvHuvWrSMjw11WtH379tLNO8JYC8oYYzz07bff0qdPH6Kjo0lMTOT000/nxx9/5IQTTmDcuHE8+uijpKenU61aNY477jhWrFjB7bffzr///W+qV6/udfphVXFaUAsWwKRJ8OSTIOJ1NsaYSBFkS6esnXbaacyePZtPP/2U66+/nsGDB3Pttdcyf/58ZsyYweuvv87kyZMZO3as16mGTcVpQX39NTz9NHzyideZGGPMn7p27cr7779Pbm4umzZtYvbs2XTp0oXff/+dxMREbrrpJm688Ubmzp3L5s2bycvL49JLL+Xxxx9n7tyje3ztitOCuuUWeO01GDwYuneHuDivMzLGGC6++GK+++472rVrh4gwYsQIkpKSmDBhAiNHjiQ2NpaqVavy9ttvs27dOvr27Yt/YsGnnnrK4+zDK2zTbYTLEQ11NGMG9OgBI0bAvfeWbmLGmHKjog511KlTp1+8zqMoZT3dRuTp3h0uuACGD4cNG7zOxhhjTDEqziE+v1GjoHVrePBBeOstr7MxxpiIsHz58qY7d+6sERMTk5OWlraw4PPZ2dnRK1eubHrgwIG4qKgobdq06coqVaoENePv4apYLSiAFi3gzjth3Dj4uVyNPG+MMWFTt27dzc2bN19a1PPr1q2rX7ly5b1paWmLmjVrtnL16tVNwp1TxStQAA89BPXquUJVzs7BGWNMONSoUWN3bGxsTlHPHzhwIL569eq7ABISEvZnZ2dXysrKCutRuIpZoGrUgCeegP/+F3zDihhjjCla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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig,ax=plt.subplots()\n",
    "ax.plot(hist.history['accuracy'], color = 'b')\n",
    "ax.plot(hist.history['val_accuracy'], linestyle=':', color = 'b')\n",
    "ax.set_ylabel(\"Accuracy\", color = 'b')\n",
    "ax.set_ylim([0,1])\n",
    "ax2=ax.twinx()\n",
    "ax2.plot(hist.history['loss'],  color = 'r')\n",
    "ax2.plot(hist.history['val_loss'], linestyle=':',  color = 'r')\n",
    "ax2.set_ylabel(\"Loss (cross-entropy)\",  color = 'r')\n",
    "fig.legend(['accuracy','val_accuracy','loss','val_loss'])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## CNN autoencoder\n",
    "\n",
    "Set up the CNN autoencoder <br>\n",
    "set up decoder with transpose convolutional layers"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Create an autoencoder for feature learning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 241,
   "metadata": {},
   "outputs": [],
   "source": [
    "latent_dim = 296\n",
    "\n",
    "class MyEncoder(tf.keras.Model):\n",
    "    \"\"\"\n",
    "    Based on Original HopeFullNet\n",
    "    \"\"\"\n",
    "    def __init__(self, inp_shape = (640,2)):\n",
    "        super(MyEncoder, self).__init__()\n",
    "        self.inp_shape = inp_shape\n",
    "\n",
    "        self.kernel_size_0 = 20\n",
    "        self.kernel_size_1 = 6\n",
    "        self.drop_rate = 0.5\n",
    "\n",
    "        self.conv1 = tf.keras.layers.Conv1D(filters=32,\n",
    "                                            kernel_size=self.kernel_size_0,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"same\",\n",
    "                                            input_shape=self.inp_shape)\n",
    "        self.batch_n_1 = tfp.bijectors.BatchNormalization()\n",
    "        self.conv2 = tf.keras.layers.Conv1D(filters=32,\n",
    "                                            kernel_size=self.kernel_size_0,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"valid\")\n",
    "        self.batch_n_2 = tfp.bijectors.BatchNormalization()\n",
    "        self.spatial_drop_1 = tf.keras.layers.SpatialDropout1D(self.drop_rate)\n",
    "        self.conv3 = tf.keras.layers.Conv1D(filters=32,\n",
    "                                            kernel_size=self.kernel_size_1,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"valid\")\n",
    "        self.avg_pool1 = tf.keras.layers.AvgPool1D(pool_size=2)\n",
    "        self.conv4 = tf.keras.layers.Conv1D(filters=32,\n",
    "                                            kernel_size=self.kernel_size_1,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"valid\")\n",
    "        self.spatial_drop_2 = tf.keras.layers.SpatialDropout1D(self.drop_rate)\n",
    "        self.flat = tf.keras.layers.Flatten()\n",
    "        self.out = tf.keras.layers.Dense(296, activation='relu')\n",
    "\n",
    "    def call(self, input_tensor):\n",
    "        conv1 = self.conv1(input_tensor)\n",
    "        batch_n_1 = self.batch_n_1(conv1)\n",
    "        conv2 = self.conv2(batch_n_1)\n",
    "        batch_n_2 = self.batch_n_2(conv2)\n",
    "        spatial_drop_1 = self.spatial_drop_1(batch_n_2)\n",
    "        conv3 = self.conv3(spatial_drop_1)\n",
    "        avg_pool1 = self.avg_pool1(conv3)\n",
    "        conv4 = self.conv4(avg_pool1)\n",
    "        spatial_drop_2 = self.spatial_drop_2(conv4)\n",
    "        flat = self.flat(spatial_drop_2)\n",
    "        return self.out(flat)\n",
    "\n",
    "class MyDecoder(tf.keras.Model):\n",
    "    \"\"\"\n",
    "    Based on Original HopeFullNet\n",
    "    \"\"\"\n",
    "    def __init__(self, inp_shape = (296,)):\n",
    "        super(MyDecoder, self).__init__()\n",
    "        self.inp_shape = inp_shape\n",
    "\n",
    "        self.kernel_size_0 = 20\n",
    "        self.kernel_size_1 = 6\n",
    "        self.drop_rate = 0.5\n",
    "\n",
    "        self.conv1 = tf.keras.layers.Conv1DTranspose(filters=32,\n",
    "                                            kernel_size=self.kernel_size_0,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"same\",\n",
    "                                            input_shape=self.inp_shape)\n",
    "        self.batch_n_1 = tfp.bijectors.BatchNormalization()\n",
    "        self.conv2 = tf.keras.layers.Conv1DTranspose(filters=32,\n",
    "                                            kernel_size=self.kernel_size_0,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"valid\")\n",
    "        self.batch_n_2 = tfp.bijectors.BatchNormalization()\n",
    "        self.spatial_drop_1 = tf.keras.layers.SpatialDropout1D(self.drop_rate)\n",
    "        self.conv3 = tf.keras.layers.Conv1DTranspose(filters=32,\n",
    "                                            kernel_size=self.kernel_size_1,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"valid\")\n",
    "        self.avg_pool1 = tf.keras.layers.AvgPool1D(pool_size=2)\n",
    "        self.conv4 = tf.keras.layers.Conv1DTranspose(filters=32,\n",
    "                                            kernel_size=self.kernel_size_1,\n",
    "                                            activation='relu',\n",
    "                                            padding= \"valid\")\n",
    "        self.spatial_drop_2 = tf.keras.layers.SpatialDropout1D(self.drop_rate)\n",
    "        self.reshape1 = tf.keras.layers.Reshape((148,2))\n",
    "        self.flat = tf.keras.layers.Flatten()\n",
    "        self.dense1 = tf.keras.layers.Dense(296, activation='relu')\n",
    "        self.dropout1 = tf.keras.layers.Dropout(self.drop_rate)\n",
    "        self.dense2 = tf.keras.layers.Dense(148, activation='relu')\n",
    "        self.dropout2 = tf.keras.layers.Dropout(self.drop_rate)\n",
    "        self.out = tf.keras.layers.Dense(1280, activation='relu')\n",
    "        self.reshape2 = tf.keras.layers.Reshape((640,2))\n",
    "\n",
    "    def call(self, input_tensor):\n",
    "        dense1 = self.dense1(input_tensor)\n",
    "        flat = self.reshape1(dense1)\n",
    "        spatial_drop_2 = self.spatial_drop_2(flat)\n",
    "        conv4 = self.conv4(spatial_drop_2)\n",
    "        avg_pool1 = self.avg_pool1(conv4)\n",
    "        conv3 = self.conv3(avg_pool1)\n",
    "        spatial_drop_1 = self.spatial_drop_1(conv3)\n",
    "        batch_n_2 = self.batch_n_2(spatial_drop_1)\n",
    "        conv2 = self.conv2(batch_n_2)\n",
    "        batch_n_1 = self.batch_n_1(conv2)\n",
    "        conv1 = self.conv1(batch_n_1)\n",
    "        flat1 = self.flat(conv1)\n",
    "        last = self.out(flat1)\n",
    "        return self.reshape2(last)\n",
    "\n",
    "\n",
    "class Autoencoder(tf.keras.models.Model):\n",
    "  def __init__(self, latent_dim):\n",
    "    super(Autoencoder, self).__init__()\n",
    "    self.latent_dim = latent_dim   \n",
    "    self.encoder = MyEncoder()\n",
    "    self.decoder = MyDecoder()\n",
    "\n",
    "  def call(self, x):\n",
    "    encoded = self.encoder(x)\n",
    "    decoded = self.decoder(encoded)\n",
    "    return decoded"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Compile the autoencoder"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 242,
   "metadata": {},
   "outputs": [],
   "source": [
    "autoencoder = Autoencoder(latent_dim)\n",
    "autoencoder.compile(optimizer='adam', loss=losses.MeanSquaredError())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Train the autoencoder"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 243,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/400\n",
      "25/25 [==============================] - 8s 222ms/step - loss: 0.1542 - val_loss: 0.0545\n",
      "Epoch 2/400\n",
      "25/25 [==============================] - 5s 217ms/step - loss: 0.0492 - val_loss: 0.0473\n",
      "Epoch 3/400\n",
      "25/25 [==============================] - 6s 236ms/step - loss: 0.0473 - val_loss: 0.0480\n",
      "Epoch 4/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0473 - val_loss: 0.0474\n",
      "Epoch 5/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0473 - val_loss: 0.0471\n",
      "Epoch 6/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0476 - val_loss: 0.0472\n",
      "Epoch 7/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0473 - val_loss: 0.0474\n",
      "Epoch 8/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0472 - val_loss: 0.0486\n",
      "Epoch 9/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0477 - val_loss: 0.0472\n",
      "Epoch 10/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0474 - val_loss: 0.0473\n",
      "Epoch 11/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0474 - val_loss: 0.0470\n",
      "Epoch 12/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0471 - val_loss: 0.0472\n",
      "Epoch 13/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0475 - val_loss: 0.0491\n",
      "Epoch 14/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0473 - val_loss: 0.0470\n",
      "Epoch 15/400\n",
      "25/25 [==============================] - 7s 274ms/step - loss: 0.0466 - val_loss: 0.0466\n",
      "Epoch 16/400\n",
      "25/25 [==============================] - 7s 271ms/step - loss: 0.0472 - val_loss: 0.0492\n",
      "Epoch 17/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0474 - val_loss: 0.0466\n",
      "Epoch 18/400\n",
      "25/25 [==============================] - 7s 279ms/step - loss: 0.0466 - val_loss: 0.0466\n",
      "Epoch 19/400\n",
      "25/25 [==============================] - 7s 280ms/step - loss: 0.0474 - val_loss: 0.0465\n",
      "Epoch 20/400\n",
      "25/25 [==============================] - 7s 293ms/step - loss: 0.0467 - val_loss: 0.0466\n",
      "Epoch 21/400\n",
      "25/25 [==============================] - 7s 286ms/step - loss: 0.0466 - val_loss: 0.0464\n",
      "Epoch 22/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0465 - val_loss: 0.0464\n",
      "Epoch 23/400\n",
      "25/25 [==============================] - 7s 283ms/step - loss: 0.0465 - val_loss: 0.0463\n",
      "Epoch 24/400\n",
      "25/25 [==============================] - 7s 281ms/step - loss: 0.0465 - val_loss: 0.0470\n",
      "Epoch 25/400\n",
      "25/25 [==============================] - 7s 290ms/step - loss: 0.0467 - val_loss: 0.0467\n",
      "Epoch 26/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0468 - val_loss: 0.0468\n",
      "Epoch 27/400\n",
      "25/25 [==============================] - 7s 289ms/step - loss: 0.0470 - val_loss: 0.0470\n",
      "Epoch 28/400\n",
      "25/25 [==============================] - 7s 294ms/step - loss: 0.0466 - val_loss: 0.0464\n",
      "Epoch 29/400\n",
      "25/25 [==============================] - 7s 287ms/step - loss: 0.0465 - val_loss: 0.0467\n",
      "Epoch 30/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0467 - val_loss: 0.0463\n",
      "Epoch 31/400\n",
      "25/25 [==============================] - 7s 284ms/step - loss: 0.0468 - val_loss: 0.0481\n",
      "Epoch 32/400\n",
      "25/25 [==============================] - 7s 284ms/step - loss: 0.0471 - val_loss: 0.0464\n",
      "Epoch 33/400\n",
      "25/25 [==============================] - 7s 287ms/step - loss: 0.0467 - val_loss: 0.0468\n",
      "Epoch 34/400\n",
      "25/25 [==============================] - 7s 281ms/step - loss: 0.0463 - val_loss: 0.0461\n",
      "Epoch 35/400\n",
      "25/25 [==============================] - 7s 283ms/step - loss: 0.0461 - val_loss: 0.0462\n",
      "Epoch 36/400\n",
      "25/25 [==============================] - 7s 282ms/step - loss: 0.0449 - val_loss: 0.0441\n",
      "Epoch 37/400\n",
      "25/25 [==============================] - 7s 282ms/step - loss: 0.0440 - val_loss: 0.0440\n",
      "Epoch 38/400\n",
      "25/25 [==============================] - 7s 284ms/step - loss: 0.0439 - val_loss: 0.0438\n",
      "Epoch 39/400\n",
      "25/25 [==============================] - 7s 302ms/step - loss: 0.0440 - val_loss: 0.0440\n",
      "Epoch 40/400\n",
      "25/25 [==============================] - 7s 292ms/step - loss: 0.0438 - val_loss: 0.0437\n",
      "Epoch 41/400\n",
      "25/25 [==============================] - 7s 294ms/step - loss: 0.0432 - val_loss: 0.0431\n",
      "Epoch 42/400\n",
      "25/25 [==============================] - 7s 296ms/step - loss: 0.0431 - val_loss: 0.0430\n",
      "Epoch 43/400\n",
      "25/25 [==============================] - 7s 299ms/step - loss: 0.0428 - val_loss: 0.0431\n",
      "Epoch 44/400\n",
      "25/25 [==============================] - 7s 276ms/step - loss: 0.0429 - val_loss: 0.0424\n",
      "Epoch 45/400\n",
      "25/25 [==============================] - 7s 299ms/step - loss: 0.0426 - val_loss: 0.0424\n",
      "Epoch 46/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0425 - val_loss: 0.0426\n",
      "Epoch 47/400\n",
      "25/25 [==============================] - 7s 283ms/step - loss: 0.0427 - val_loss: 0.0424\n",
      "Epoch 48/400\n",
      "25/25 [==============================] - 7s 286ms/step - loss: 0.0428 - val_loss: 0.0424\n",
      "Epoch 49/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0425 - val_loss: 0.0424\n",
      "Epoch 50/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0425 - val_loss: 0.0424\n",
      "Epoch 51/400\n",
      "25/25 [==============================] - 7s 293ms/step - loss: 0.0426 - val_loss: 0.0428\n",
      "Epoch 52/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0425 - val_loss: 0.0424\n",
      "Epoch 53/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0425 - val_loss: 0.0424\n",
      "Epoch 54/400\n",
      "25/25 [==============================] - 7s 283ms/step - loss: 0.0425 - val_loss: 0.0425\n",
      "Epoch 55/400\n",
      "25/25 [==============================] - 7s 287ms/step - loss: 0.0425 - val_loss: 0.0425\n",
      "Epoch 56/400\n",
      "25/25 [==============================] - 7s 284ms/step - loss: 0.0424 - val_loss: 0.0424\n",
      "Epoch 57/400\n",
      "25/25 [==============================] - 7s 289ms/step - loss: 0.0425 - val_loss: 0.0424\n",
      "Epoch 58/400\n",
      "25/25 [==============================] - 7s 284ms/step - loss: 0.0425 - val_loss: 0.0425\n",
      "Epoch 59/400\n",
      "25/25 [==============================] - 7s 287ms/step - loss: 0.0425 - val_loss: 0.0424\n",
      "Epoch 60/400\n",
      "25/25 [==============================] - 7s 282ms/step - loss: 0.0424 - val_loss: 0.0425\n",
      "Epoch 61/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0425 - val_loss: 0.0427\n",
      "Epoch 62/400\n",
      "25/25 [==============================] - 8s 308ms/step - loss: 0.0423 - val_loss: 0.0424\n",
      "Epoch 63/400\n",
      "25/25 [==============================] - 8s 307ms/step - loss: 0.0421 - val_loss: 0.0421\n",
      "Epoch 64/400\n",
      "25/25 [==============================] - 8s 312ms/step - loss: 0.0415 - val_loss: 0.0416\n",
      "Epoch 65/400\n",
      "25/25 [==============================] - 7s 303ms/step - loss: 0.0418 - val_loss: 0.0416\n",
      "Epoch 66/400\n",
      "25/25 [==============================] - 8s 306ms/step - loss: 0.0418 - val_loss: 0.0417\n",
      "Epoch 67/400\n",
      "25/25 [==============================] - 8s 305ms/step - loss: 0.0418 - val_loss: 0.0420\n",
      "Epoch 68/400\n",
      "25/25 [==============================] - 8s 308ms/step - loss: 0.0418 - val_loss: 0.0417\n",
      "Epoch 69/400\n",
      "25/25 [==============================] - 8s 318ms/step - loss: 0.0418 - val_loss: 0.0422\n",
      "Epoch 70/400\n",
      "25/25 [==============================] - 8s 320ms/step - loss: 0.0418 - val_loss: 0.0417\n",
      "Epoch 71/400\n",
      "25/25 [==============================] - 8s 342ms/step - loss: 0.0418 - val_loss: 0.0417\n",
      "Epoch 72/400\n",
      "25/25 [==============================] - 8s 305ms/step - loss: 0.0417 - val_loss: 0.0421\n",
      "Epoch 73/400\n",
      "25/25 [==============================] - 8s 307ms/step - loss: 0.0418 - val_loss: 0.0419\n",
      "Epoch 74/400\n",
      "25/25 [==============================] - 8s 317ms/step - loss: 0.0418 - val_loss: 0.0416\n",
      "Epoch 75/400\n",
      "25/25 [==============================] - 8s 315ms/step - loss: 0.0416 - val_loss: 0.0416\n",
      "Epoch 76/400\n",
      "25/25 [==============================] - 8s 305ms/step - loss: 0.0417 - val_loss: 0.0417\n",
      "Epoch 77/400\n",
      "25/25 [==============================] - 8s 327ms/step - loss: 0.0418 - val_loss: 0.0423\n",
      "Epoch 78/400\n",
      "25/25 [==============================] - 8s 314ms/step - loss: 0.0419 - val_loss: 0.0418\n",
      "Epoch 79/400\n",
      "25/25 [==============================] - 8s 314ms/step - loss: 0.0417 - val_loss: 0.0417\n",
      "Epoch 80/400\n",
      "25/25 [==============================] - 8s 322ms/step - loss: 0.0418 - val_loss: 0.0418\n",
      "Epoch 81/400\n",
      "25/25 [==============================] - 7s 278ms/step - loss: 0.0417 - val_loss: 0.0417\n",
      "Epoch 82/400\n",
      "25/25 [==============================] - 7s 294ms/step - loss: 0.0417 - val_loss: 0.0418\n",
      "Epoch 83/400\n",
      "25/25 [==============================] - 7s 287ms/step - loss: 0.0418 - val_loss: 0.0416\n",
      "Epoch 84/400\n",
      "25/25 [==============================] - 7s 276ms/step - loss: 0.0417 - val_loss: 0.0418\n",
      "Epoch 85/400\n",
      "25/25 [==============================] - 7s 274ms/step - loss: 0.0418 - val_loss: 0.0417\n",
      "Epoch 86/400\n",
      "25/25 [==============================] - 7s 273ms/step - loss: 0.0417 - val_loss: 0.0420\n",
      "Epoch 87/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0418 - val_loss: 0.0419\n",
      "Epoch 88/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0418 - val_loss: 0.0418\n",
      "Epoch 89/400\n",
      "25/25 [==============================] - 7s 284ms/step - loss: 0.0418 - val_loss: 0.0417\n",
      "Epoch 90/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0417 - val_loss: 0.0417\n",
      "Epoch 91/400\n",
      "25/25 [==============================] - 7s 263ms/step - loss: 0.0419 - val_loss: 0.0422\n",
      "Epoch 92/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0419 - val_loss: 0.0418\n",
      "Epoch 93/400\n",
      "25/25 [==============================] - 6s 251ms/step - loss: 0.0417 - val_loss: 0.0417\n",
      "Epoch 94/400\n",
      "25/25 [==============================] - 6s 252ms/step - loss: 0.0418 - val_loss: 0.0416\n",
      "Epoch 95/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0417 - val_loss: 0.0419\n",
      "Epoch 96/400\n",
      "25/25 [==============================] - 6s 252ms/step - loss: 0.0418 - val_loss: 0.0419\n",
      "Epoch 97/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0418 - val_loss: 0.0417\n",
      "Epoch 98/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0418 - val_loss: 0.0416\n",
      "Epoch 99/400\n",
      "25/25 [==============================] - 6s 250ms/step - loss: 0.0414 - val_loss: 0.0410\n",
      "Epoch 100/400\n",
      "25/25 [==============================] - 6s 252ms/step - loss: 0.0412 - val_loss: 0.0410\n",
      "Epoch 101/400\n",
      "25/25 [==============================] - 7s 275ms/step - loss: 0.0410 - val_loss: 0.0409\n",
      "Epoch 102/400\n",
      "25/25 [==============================] - 6s 254ms/step - loss: 0.0409 - val_loss: 0.0408\n",
      "Epoch 103/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0410 - val_loss: 0.0408\n",
      "Epoch 104/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0410 - val_loss: 0.0408\n",
      "Epoch 105/400\n",
      "25/25 [==============================] - 7s 263ms/step - loss: 0.0409 - val_loss: 0.0409\n",
      "Epoch 106/400\n",
      "25/25 [==============================] - 6s 254ms/step - loss: 0.0412 - val_loss: 0.0412\n",
      "Epoch 107/400\n",
      "25/25 [==============================] - 6s 252ms/step - loss: 0.0409 - val_loss: 0.0410\n",
      "Epoch 108/400\n",
      "25/25 [==============================] - 6s 251ms/step - loss: 0.0410 - val_loss: 0.0408\n",
      "Epoch 109/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0410 - val_loss: 0.0408\n",
      "Epoch 110/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0409 - val_loss: 0.0409\n",
      "Epoch 111/400\n",
      "25/25 [==============================] - 6s 252ms/step - loss: 0.0409 - val_loss: 0.0408\n",
      "Epoch 112/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0409 - val_loss: 0.0409\n",
      "Epoch 113/400\n",
      "25/25 [==============================] - 6s 261ms/step - loss: 0.0409 - val_loss: 0.0410\n",
      "Epoch 114/400\n",
      "25/25 [==============================] - 6s 251ms/step - loss: 0.0410 - val_loss: 0.0410\n",
      "Epoch 115/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0411 - val_loss: 0.0409\n",
      "Epoch 116/400\n",
      "25/25 [==============================] - 6s 252ms/step - loss: 0.0410 - val_loss: 0.0409\n",
      "Epoch 117/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0410 - val_loss: 0.0409\n",
      "Epoch 118/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0410 - val_loss: 0.0408\n",
      "Epoch 119/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0410 - val_loss: 0.0409\n",
      "Epoch 120/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0409 - val_loss: 0.0413\n",
      "Epoch 121/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0410 - val_loss: 0.0409\n",
      "Epoch 122/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0410 - val_loss: 0.0410\n",
      "Epoch 123/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0410 - val_loss: 0.0408\n",
      "Epoch 124/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0409 - val_loss: 0.0410\n",
      "Epoch 125/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0410 - val_loss: 0.0409\n",
      "Epoch 126/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0410 - val_loss: 0.0418\n",
      "Epoch 127/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0409 - val_loss: 0.0410\n",
      "Epoch 128/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0411 - val_loss: 0.0408\n",
      "Epoch 129/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0411 - val_loss: 0.0406\n",
      "Epoch 130/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0410 - val_loss: 0.0407\n",
      "Epoch 131/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0407 - val_loss: 0.0406\n",
      "Epoch 132/400\n",
      "25/25 [==============================] - 6s 252ms/step - loss: 0.0408 - val_loss: 0.0408\n",
      "Epoch 133/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0408 - val_loss: 0.0408\n",
      "Epoch 134/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0408 - val_loss: 0.0406\n",
      "Epoch 135/400\n",
      "25/25 [==============================] - 6s 252ms/step - loss: 0.0408 - val_loss: 0.0408\n",
      "Epoch 136/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0408 - val_loss: 0.0406\n",
      "Epoch 137/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0407 - val_loss: 0.0408\n",
      "Epoch 138/400\n",
      "25/25 [==============================] - 6s 251ms/step - loss: 0.0407 - val_loss: 0.0407\n",
      "Epoch 139/400\n",
      "25/25 [==============================] - 6s 252ms/step - loss: 0.0408 - val_loss: 0.0406\n",
      "Epoch 140/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0408 - val_loss: 0.0407\n",
      "Epoch 141/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0410 - val_loss: 0.0407\n",
      "Epoch 142/400\n",
      "25/25 [==============================] - 6s 254ms/step - loss: 0.0408 - val_loss: 0.0408\n",
      "Epoch 143/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0408 - val_loss: 0.0413\n",
      "Epoch 144/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0409 - val_loss: 0.0409\n",
      "Epoch 145/400\n",
      "25/25 [==============================] - 8s 317ms/step - loss: 0.0411 - val_loss: 0.0409\n",
      "Epoch 146/400\n",
      "25/25 [==============================] - 12s 480ms/step - loss: 0.0408 - val_loss: 0.0406\n",
      "Epoch 147/400\n",
      "25/25 [==============================] - 9s 377ms/step - loss: 0.0408 - val_loss: 0.0406\n",
      "Epoch 148/400\n",
      "25/25 [==============================] - 10s 408ms/step - loss: 0.0407 - val_loss: 0.0407\n",
      "Epoch 149/400\n",
      "25/25 [==============================] - 11s 436ms/step - loss: 0.0407 - val_loss: 0.0407\n",
      "Epoch 150/400\n",
      "25/25 [==============================] - 11s 446ms/step - loss: 0.0409 - val_loss: 0.0407\n",
      "Epoch 151/400\n",
      "25/25 [==============================] - 11s 443ms/step - loss: 0.0407 - val_loss: 0.0408\n",
      "Epoch 152/400\n",
      "25/25 [==============================] - 11s 424ms/step - loss: 0.0407 - val_loss: 0.0407\n",
      "Epoch 153/400\n",
      "25/25 [==============================] - 10s 422ms/step - loss: 0.0407 - val_loss: 0.0409\n",
      "Epoch 154/400\n",
      "25/25 [==============================] - 11s 440ms/step - loss: 0.0407 - val_loss: 0.0404\n",
      "Epoch 155/400\n",
      "25/25 [==============================] - 11s 436ms/step - loss: 0.0407 - val_loss: 0.0406\n",
      "Epoch 156/400\n",
      "25/25 [==============================] - 11s 455ms/step - loss: 0.0405 - val_loss: 0.0405\n",
      "Epoch 157/400\n",
      "25/25 [==============================] - 10s 405ms/step - loss: 0.0406 - val_loss: 0.0412\n",
      "Epoch 158/400\n",
      "25/25 [==============================] - 9s 379ms/step - loss: 0.0406 - val_loss: 0.0404\n",
      "Epoch 159/400\n",
      "25/25 [==============================] - 9s 347ms/step - loss: 0.0405 - val_loss: 0.0409\n",
      "Epoch 160/400\n",
      "25/25 [==============================] - 8s 331ms/step - loss: 0.0406 - val_loss: 0.0405\n",
      "Epoch 161/400\n",
      "25/25 [==============================] - 8s 303ms/step - loss: 0.0405 - val_loss: 0.0404\n",
      "Epoch 162/400\n",
      "25/25 [==============================] - 8s 319ms/step - loss: 0.0406 - val_loss: 0.0404\n",
      "Epoch 163/400\n",
      "25/25 [==============================] - 7s 296ms/step - loss: 0.0405 - val_loss: 0.0404\n",
      "Epoch 164/400\n",
      "25/25 [==============================] - 8s 312ms/step - loss: 0.0407 - val_loss: 0.0407\n",
      "Epoch 165/400\n",
      "25/25 [==============================] - 7s 287ms/step - loss: 0.0405 - val_loss: 0.0404\n",
      "Epoch 166/400\n",
      "25/25 [==============================] - 7s 294ms/step - loss: 0.0406 - val_loss: 0.0405\n",
      "Epoch 167/400\n",
      "25/25 [==============================] - 7s 293ms/step - loss: 0.0407 - val_loss: 0.0405\n",
      "Epoch 168/400\n",
      "25/25 [==============================] - 7s 295ms/step - loss: 0.0406 - val_loss: 0.0403\n",
      "Epoch 169/400\n",
      "25/25 [==============================] - 7s 287ms/step - loss: 0.0405 - val_loss: 0.0403\n",
      "Epoch 170/400\n",
      "25/25 [==============================] - 7s 294ms/step - loss: 0.0404 - val_loss: 0.0403\n",
      "Epoch 171/400\n",
      "25/25 [==============================] - 7s 286ms/step - loss: 0.0404 - val_loss: 0.0410\n",
      "Epoch 172/400\n",
      "25/25 [==============================] - 7s 293ms/step - loss: 0.0405 - val_loss: 0.0403\n",
      "Epoch 173/400\n",
      "25/25 [==============================] - 7s 286ms/step - loss: 0.0403 - val_loss: 0.0403\n",
      "Epoch 174/400\n",
      "25/25 [==============================] - 7s 286ms/step - loss: 0.0405 - val_loss: 0.0402\n",
      "Epoch 175/400\n",
      "25/25 [==============================] - 7s 298ms/step - loss: 0.0403 - val_loss: 0.0403\n",
      "Epoch 176/400\n",
      "25/25 [==============================] - 7s 279ms/step - loss: 0.0404 - val_loss: 0.0404\n",
      "Epoch 177/400\n",
      "25/25 [==============================] - 7s 279ms/step - loss: 0.0405 - val_loss: 0.0403\n",
      "Epoch 178/400\n",
      "25/25 [==============================] - 7s 273ms/step - loss: 0.0404 - val_loss: 0.0404\n",
      "Epoch 179/400\n",
      "25/25 [==============================] - 7s 277ms/step - loss: 0.0403 - val_loss: 0.0407\n",
      "Epoch 180/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0403 - val_loss: 0.0406\n",
      "Epoch 181/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0404 - val_loss: 0.0403\n",
      "Epoch 182/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0407 - val_loss: 0.0406\n",
      "Epoch 183/400\n",
      "25/25 [==============================] - 6s 260ms/step - loss: 0.0405 - val_loss: 0.0403\n",
      "Epoch 184/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0404 - val_loss: 0.0403\n",
      "Epoch 185/400\n",
      "25/25 [==============================] - 7s 263ms/step - loss: 0.0403 - val_loss: 0.0402\n",
      "Epoch 186/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0404 - val_loss: 0.0403\n",
      "Epoch 187/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0403 - val_loss: 0.0403\n",
      "Epoch 188/400\n",
      "25/25 [==============================] - 7s 270ms/step - loss: 0.0405 - val_loss: 0.0402\n",
      "Epoch 189/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0402 - val_loss: 0.0402\n",
      "Epoch 190/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0402 - val_loss: 0.0401\n",
      "Epoch 191/400\n",
      "25/25 [==============================] - 7s 272ms/step - loss: 0.0402 - val_loss: 0.0401\n",
      "Epoch 192/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0402 - val_loss: 0.0401\n",
      "Epoch 193/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0402 - val_loss: 0.0405\n",
      "Epoch 194/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0402 - val_loss: 0.0401\n",
      "Epoch 195/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0402 - val_loss: 0.0402\n",
      "Epoch 196/400\n",
      "25/25 [==============================] - 7s 263ms/step - loss: 0.0403 - val_loss: 0.0401\n",
      "Epoch 197/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0402 - val_loss: 0.0410\n",
      "Epoch 198/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0406 - val_loss: 0.0406\n",
      "Epoch 199/400\n",
      "25/25 [==============================] - 6s 261ms/step - loss: 0.0404 - val_loss: 0.0403\n",
      "Epoch 200/400\n",
      "25/25 [==============================] - 6s 261ms/step - loss: 0.0403 - val_loss: 0.0402\n",
      "Epoch 201/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0403 - val_loss: 0.0403\n",
      "Epoch 202/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0402 - val_loss: 0.0404\n",
      "Epoch 203/400\n",
      "25/25 [==============================] - 7s 263ms/step - loss: 0.0403 - val_loss: 0.0398\n",
      "Epoch 204/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0400 - val_loss: 0.0403\n",
      "Epoch 205/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0400 - val_loss: 0.0397\n",
      "Epoch 206/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0398 - val_loss: 0.0396\n",
      "Epoch 207/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0398 - val_loss: 0.0396\n",
      "Epoch 208/400\n",
      "25/25 [==============================] - 7s 271ms/step - loss: 0.0397 - val_loss: 0.0397\n",
      "Epoch 209/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0398 - val_loss: 0.0396\n",
      "Epoch 210/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0397 - val_loss: 0.0397\n",
      "Epoch 211/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0397 - val_loss: 0.0398\n",
      "Epoch 212/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 213/400\n",
      "25/25 [==============================] - 7s 272ms/step - loss: 0.0396 - val_loss: 0.0396\n",
      "Epoch 214/400\n",
      "25/25 [==============================] - 7s 278ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 215/400\n",
      "25/25 [==============================] - 7s 279ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 216/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0396 - val_loss: 0.0396\n",
      "Epoch 217/400\n",
      "25/25 [==============================] - 7s 274ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 218/400\n",
      "25/25 [==============================] - 7s 276ms/step - loss: 0.0396 - val_loss: 0.0395\n",
      "Epoch 219/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0397 - val_loss: 0.0395\n",
      "Epoch 220/400\n",
      "25/25 [==============================] - 7s 272ms/step - loss: 0.0396 - val_loss: 0.0408\n",
      "Epoch 221/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0401 - val_loss: 0.0410\n",
      "Epoch 222/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0402 - val_loss: 0.0399\n",
      "Epoch 223/400\n",
      "25/25 [==============================] - 7s 296ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 224/400\n",
      "25/25 [==============================] - 7s 295ms/step - loss: 0.0397 - val_loss: 0.0397\n",
      "Epoch 225/400\n",
      "25/25 [==============================] - 7s 289ms/step - loss: 0.0398 - val_loss: 0.0399\n",
      "Epoch 226/400\n",
      "25/25 [==============================] - 7s 294ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 227/400\n",
      "25/25 [==============================] - 7s 292ms/step - loss: 0.0397 - val_loss: 0.0397\n",
      "Epoch 228/400\n",
      "25/25 [==============================] - 7s 280ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 229/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0397 - val_loss: 0.0397\n",
      "Epoch 230/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 231/400\n",
      "25/25 [==============================] - 7s 272ms/step - loss: 0.0398 - val_loss: 0.0398\n",
      "Epoch 232/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 233/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0396 - val_loss: 0.0395\n",
      "Epoch 234/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0398 - val_loss: 0.0396\n",
      "Epoch 235/400\n",
      "25/25 [==============================] - 7s 271ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 236/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0396 - val_loss: 0.0396\n",
      "Epoch 237/400\n",
      "25/25 [==============================] - 7s 271ms/step - loss: 0.0397 - val_loss: 0.0397\n",
      "Epoch 238/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0398 - val_loss: 0.0396\n",
      "Epoch 239/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0397 - val_loss: 0.0397\n",
      "Epoch 240/400\n",
      "25/25 [==============================] - 7s 270ms/step - loss: 0.0397 - val_loss: 0.0395\n",
      "Epoch 241/400\n",
      "25/25 [==============================] - 7s 280ms/step - loss: 0.0396 - val_loss: 0.0396\n",
      "Epoch 242/400\n",
      "25/25 [==============================] - 7s 290ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 243/400\n",
      "25/25 [==============================] - 7s 292ms/step - loss: 0.0399 - val_loss: 0.0396\n",
      "Epoch 244/400\n",
      "25/25 [==============================] - 7s 292ms/step - loss: 0.0395 - val_loss: 0.0395\n",
      "Epoch 245/400\n",
      "25/25 [==============================] - 8s 301ms/step - loss: 0.0395 - val_loss: 0.0402\n",
      "Epoch 246/400\n",
      "25/25 [==============================] - 7s 293ms/step - loss: 0.0398 - val_loss: 0.0394\n",
      "Epoch 247/400\n",
      "25/25 [==============================] - 7s 273ms/step - loss: 0.0396 - val_loss: 0.0394\n",
      "Epoch 248/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0395 - val_loss: 0.0395\n",
      "Epoch 249/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0395 - val_loss: 0.0393\n",
      "Epoch 250/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 251/400\n",
      "25/25 [==============================] - 7s 262ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 252/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0395 - val_loss: 0.0395\n",
      "Epoch 253/400\n",
      "25/25 [==============================] - 6s 261ms/step - loss: 0.0395 - val_loss: 0.0396\n",
      "Epoch 254/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0396 - val_loss: 0.0394\n",
      "Epoch 255/400\n",
      "25/25 [==============================] - 6s 261ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 256/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0394 - val_loss: 0.0393\n",
      "Epoch 257/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 258/400\n",
      "25/25 [==============================] - 7s 272ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 259/400\n",
      "25/25 [==============================] - 7s 273ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 260/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 261/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0395 - val_loss: 0.0395\n",
      "Epoch 262/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 263/400\n",
      "25/25 [==============================] - 7s 270ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 264/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0396 - val_loss: 0.0394\n",
      "Epoch 265/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 266/400\n",
      "25/25 [==============================] - 7s 262ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 267/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0395 - val_loss: 0.0393\n",
      "Epoch 268/400\n",
      "25/25 [==============================] - 7s 263ms/step - loss: 0.0394 - val_loss: 0.0396\n",
      "Epoch 269/400\n",
      "25/25 [==============================] - 7s 264ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 270/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 271/400\n",
      "25/25 [==============================] - 7s 270ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 272/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 273/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 274/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 275/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 276/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 277/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0396 - val_loss: 0.0394\n",
      "Epoch 278/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0396 - val_loss: 0.0395\n",
      "Epoch 279/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0395 - val_loss: 0.0396\n",
      "Epoch 280/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 281/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0394 - val_loss: 0.0395\n",
      "Epoch 282/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0394 - val_loss: 0.0397\n",
      "Epoch 283/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0397 - val_loss: 0.0396\n",
      "Epoch 284/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0396 - val_loss: 0.0396\n",
      "Epoch 285/400\n",
      "25/25 [==============================] - 6s 260ms/step - loss: 0.0394 - val_loss: 0.0393\n",
      "Epoch 286/400\n",
      "25/25 [==============================] - 7s 294ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 287/400\n",
      "25/25 [==============================] - 7s 299ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 288/400\n",
      "25/25 [==============================] - 7s 282ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 289/400\n",
      "25/25 [==============================] - 7s 285ms/step - loss: 0.0394 - val_loss: 0.0395\n",
      "Epoch 290/400\n",
      "25/25 [==============================] - 7s 287ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 291/400\n",
      "25/25 [==============================] - 7s 291ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 292/400\n",
      "25/25 [==============================] - 7s 272ms/step - loss: 0.0395 - val_loss: 0.0394\n",
      "Epoch 293/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0394 - val_loss: 0.0394\n",
      "Epoch 294/400\n",
      "25/25 [==============================] - 7s 270ms/step - loss: 0.0394 - val_loss: 0.0393\n",
      "Epoch 295/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0393 - val_loss: 0.0393\n",
      "Epoch 296/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 297/400\n",
      "25/25 [==============================] - 7s 272ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 298/400\n",
      "25/25 [==============================] - 7s 276ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 299/400\n",
      "25/25 [==============================] - 8s 314ms/step - loss: 0.0392 - val_loss: 0.0392\n",
      "Epoch 300/400\n",
      "25/25 [==============================] - 7s 277ms/step - loss: 0.0392 - val_loss: 0.0398\n",
      "Epoch 301/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0394 - val_loss: 0.0392\n",
      "Epoch 302/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 303/400\n",
      "25/25 [==============================] - 7s 280ms/step - loss: 0.0392 - val_loss: 0.0392\n",
      "Epoch 304/400\n",
      "25/25 [==============================] - 7s 280ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 305/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 306/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 307/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0392 - val_loss: 0.0392\n",
      "Epoch 308/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 309/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 310/400\n",
      "25/25 [==============================] - 7s 272ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 311/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0393 - val_loss: 0.0392\n",
      "Epoch 312/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0393 - val_loss: 0.0393\n",
      "Epoch 313/400\n",
      "25/25 [==============================] - 7s 265ms/step - loss: 0.0392 - val_loss: 0.0392\n",
      "Epoch 314/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0392 - val_loss: 0.0392\n",
      "Epoch 315/400\n",
      "25/25 [==============================] - 7s 274ms/step - loss: 0.0394 - val_loss: 0.0392\n",
      "Epoch 316/400\n",
      "25/25 [==============================] - 7s 267ms/step - loss: 0.0394 - val_loss: 0.0389\n",
      "Epoch 317/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0391 - val_loss: 0.0392\n",
      "Epoch 318/400\n",
      "25/25 [==============================] - 7s 270ms/step - loss: 0.0392 - val_loss: 0.0389\n",
      "Epoch 319/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0391 - val_loss: 0.0390\n",
      "Epoch 320/400\n",
      "25/25 [==============================] - 7s 270ms/step - loss: 0.0391 - val_loss: 0.0391\n",
      "Epoch 321/400\n",
      "25/25 [==============================] - 7s 263ms/step - loss: 0.0390 - val_loss: 0.0389\n",
      "Epoch 322/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0391 - val_loss: 0.0392\n",
      "Epoch 323/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0396 - val_loss: 0.0390\n",
      "Epoch 324/400\n",
      "25/25 [==============================] - 6s 260ms/step - loss: 0.0393 - val_loss: 0.0390\n",
      "Epoch 325/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0391 - val_loss: 0.0391\n",
      "Epoch 326/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0391 - val_loss: 0.0390\n",
      "Epoch 327/400\n",
      "25/25 [==============================] - 7s 270ms/step - loss: 0.0390 - val_loss: 0.0389\n",
      "Epoch 328/400\n",
      "25/25 [==============================] - 6s 251ms/step - loss: 0.0391 - val_loss: 0.0389\n",
      "Epoch 329/400\n",
      "25/25 [==============================] - 7s 266ms/step - loss: 0.0394 - val_loss: 0.0395\n",
      "Epoch 330/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0390 - val_loss: 0.0388\n",
      "Epoch 331/400\n",
      "25/25 [==============================] - 7s 262ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 332/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 333/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 334/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 335/400\n",
      "25/25 [==============================] - 6s 254ms/step - loss: 0.0389 - val_loss: 0.0388\n",
      "Epoch 336/400\n",
      "25/25 [==============================] - 6s 261ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 337/400\n",
      "25/25 [==============================] - 6s 260ms/step - loss: 0.0388 - val_loss: 0.0389\n",
      "Epoch 338/400\n",
      "25/25 [==============================] - 7s 263ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 339/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 340/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0388 - val_loss: 0.0389\n",
      "Epoch 341/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0388 - val_loss: 0.0388\n",
      "Epoch 342/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 343/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 344/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0388 - val_loss: 0.0386\n",
      "Epoch 345/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0387 - val_loss: 0.0387\n",
      "Epoch 346/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0387 - val_loss: 0.0387\n",
      "Epoch 347/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 348/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0387 - val_loss: 0.0387\n",
      "Epoch 349/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 350/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 351/400\n",
      "25/25 [==============================] - 6s 260ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 352/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 353/400\n",
      "25/25 [==============================] - 6s 261ms/step - loss: 0.0387 - val_loss: 0.0387\n",
      "Epoch 354/400\n",
      "25/25 [==============================] - 7s 279ms/step - loss: 0.0388 - val_loss: 0.0388\n",
      "Epoch 355/400\n",
      "25/25 [==============================] - 6s 260ms/step - loss: 0.0388 - val_loss: 0.0388\n",
      "Epoch 356/400\n",
      "25/25 [==============================] - 7s 269ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 357/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0388 - val_loss: 0.0386\n",
      "Epoch 358/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 359/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0387 - val_loss: 0.0390\n",
      "Epoch 360/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0388 - val_loss: 0.0388\n",
      "Epoch 361/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0388 - val_loss: 0.0389\n",
      "Epoch 362/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 363/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0388 - val_loss: 0.0389\n",
      "Epoch 364/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0388 - val_loss: 0.0390\n",
      "Epoch 365/400\n",
      "25/25 [==============================] - 6s 253ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 366/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0389 - val_loss: 0.0387\n",
      "Epoch 367/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0388 - val_loss: 0.0386\n",
      "Epoch 368/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0387 - val_loss: 0.0387\n",
      "Epoch 369/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0389 - val_loss: 0.0388\n",
      "Epoch 370/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0390 - val_loss: 0.0387\n",
      "Epoch 371/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0389 - val_loss: 0.0392\n",
      "Epoch 372/400\n",
      "25/25 [==============================] - 6s 260ms/step - loss: 0.0390 - val_loss: 0.0387\n",
      "Epoch 373/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 374/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0387 - val_loss: 0.0387\n",
      "Epoch 375/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 376/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0388 - val_loss: 0.0386\n",
      "Epoch 377/400\n",
      "25/25 [==============================] - 7s 263ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 378/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0388 - val_loss: 0.0388\n",
      "Epoch 379/400\n",
      "25/25 [==============================] - 6s 254ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 380/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0390 - val_loss: 0.0387\n",
      "Epoch 381/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 382/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0388 - val_loss: 0.0389\n",
      "Epoch 383/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 384/400\n",
      "25/25 [==============================] - 6s 256ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 385/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 386/400\n",
      "25/25 [==============================] - 7s 268ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 387/400\n",
      "25/25 [==============================] - 6s 248ms/step - loss: 0.0387 - val_loss: 0.0387\n",
      "Epoch 388/400\n",
      "25/25 [==============================] - 7s 261ms/step - loss: 0.0388 - val_loss: 0.0387\n",
      "Epoch 389/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0388 - val_loss: 0.0388\n",
      "Epoch 390/400\n",
      "25/25 [==============================] - 6s 262ms/step - loss: 0.0388 - val_loss: 0.0386\n",
      "Epoch 391/400\n",
      "25/25 [==============================] - 6s 255ms/step - loss: 0.0386 - val_loss: 0.0385\n",
      "Epoch 392/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0386 - val_loss: 0.0385\n",
      "Epoch 393/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0386 - val_loss: 0.0385\n",
      "Epoch 394/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0387 - val_loss: 0.0386\n",
      "Epoch 395/400\n",
      "25/25 [==============================] - 6s 261ms/step - loss: 0.0386 - val_loss: 0.0386\n",
      "Epoch 396/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0386 - val_loss: 0.0386\n",
      "Epoch 397/400\n",
      "25/25 [==============================] - 6s 257ms/step - loss: 0.0387 - val_loss: 0.0385\n",
      "Epoch 398/400\n",
      "25/25 [==============================] - 6s 260ms/step - loss: 0.0386 - val_loss: 0.0385\n",
      "Epoch 399/400\n",
      "25/25 [==============================] - 6s 258ms/step - loss: 0.0386 - val_loss: 0.0389\n",
      "Epoch 400/400\n",
      "25/25 [==============================] - 6s 259ms/step - loss: 0.0388 - val_loss: 0.0385\n"
     ]
    }
   ],
   "source": [
    "hist = autoencoder.fit(x_train_reshaped, x_train_reshaped,\n",
    "                epochs=400,\n",
    "                shuffle=True,\n",
    "                validation_data=(x_valid_reshaped, x_valid_reshaped))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 244,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x1894773e220>"
      ]
     },
     "execution_count": 244,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(hist.history['loss'])\n",
    "plt.plot(hist.history['val_loss'])\n",
    "plt.legend(['loss', 'val_loss'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 245,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "WARNING:tensorflow:Skipping full serialization of Keras layer <keras.layers.core.dropout.Dropout object at 0x000001894714B220>, because it is not built.\n",
      "WARNING:tensorflow:Skipping full serialization of Keras layer <keras.layers.core.dense.Dense object at 0x000001894714B340>, because it is not built.\n",
      "WARNING:tensorflow:Skipping full serialization of Keras layer <keras.layers.core.dropout.Dropout object at 0x000001894714B790>, because it is not built.\n",
      "WARNING:tensorflow:From C:\\Users\\james\\AppData\\Local\\Packages\\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\\LocalCache\\local-packages\\Python39\\site-packages\\tensorflow\\python\\training\\tracking\\autotrackable.py:90: Bijector.has_static_min_event_ndims (from tensorflow_probability.python.bijectors.bijector) is deprecated and will be removed after 2021-08-01.\n",
      "Instructions for updating:\n",
      "`min_event_ndims` is now static for all bijectors; this property is no longer needed.\n",
      "INFO:tensorflow:Assets written to: C:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\autoencoderOnlineDataModel\\assets\n"
     ]
    }
   ],
   "source": [
    "\n",
    "autoencoder.build(input_shape=(None, 640,2))\n",
    "autoencoder.save(filepath+'\\\\models\\\\autoencoderOnlineDataModel')\n",
    "# tf.keras.models.save_model(\n",
    "#     autoencoder,\n",
    "#     filepath+'\\\\autoencoderModel',\n",
    "#     overwrite=True,\n",
    "#     include_optimizer=True,\n",
    "#     save_format=None,\n",
    "#     signatures=None,\n",
    "#     options=None,\n",
    "#     save_traces=True\n",
    "# )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 246,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"autoencoder\"\n",
      "_________________________________________________________________\n",
      " Layer (type)                Output Shape              Param #   \n",
      "=================================================================\n",
      " my_encoder (MyEncoder)      multiple                  2904744   \n",
      "                                                                 \n",
      " my_decoder (MyDecoder)      multiple                  4233064   \n",
      "                                                                 \n",
      "=================================================================\n",
      "Total params: 7,137,808\n",
      "Trainable params: 7,137,552\n",
      "Non-trainable params: 256\n",
      "_________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "autoencoder.summary()\n",
    "\n",
    "# # define an encoder model (without the decoder)\n",
    "# encoder = tf.keras.models.Model(autoencoder.input, autoencoder.layers[0].output)\n",
    "# # save the encoder to file\n",
    "# encoder.summary()\n",
    "# encoder.save(filepath+'\\\\encoderModel')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## append an MLP to the trained encoder\n",
    "\n",
    "(Brain Surgery) <br>\n",
    "\n",
    "Clip off the encoder part of the neural network<br>\n",
    "Freeze the lower convoluutional layers<br>\n",
    "\n",
    "Connect to another couple of fully connected layers<br>\n",
    "Only train those last few layers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 278,
   "metadata": {},
   "outputs": [],
   "source": [
    "autoencoder_loaded = tf.keras.models.load_model(filepath+'\\\\models\\\\autoencoderOnlineDataModel')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Freeze encoder and add an MLP to the output of the encoder in another network"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 279,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<keras.layers.convolutional.Conv1D object at 0x000001893C969B20>\n",
      "False\n",
      "<keras.layers.convolutional.Conv1D object at 0x00000189470697C0>\n",
      "False\n",
      "<keras.layers.core.spatial_dropout.SpatialDropout1D object at 0x0000018947099E20>\n",
      "False\n",
      "<keras.layers.convolutional.Conv1D object at 0x0000018947099AF0>\n",
      "False\n",
      "<keras.layers.pooling.AveragePooling1D object at 0x0000018947099CD0>\n",
      "False\n",
      "<keras.layers.convolutional.Conv1D object at 0x00000189470D8070>\n",
      "False\n",
      "<keras.layers.core.spatial_dropout.SpatialDropout1D object at 0x00000189470D87C0>\n",
      "False\n",
      "<keras.layers.core.flatten.Flatten object at 0x00000189470D8C40>\n",
      "False\n",
      "<keras.layers.core.dense.Dense object at 0x0000018936A6EAC0>\n",
      "True\n",
      "<keras.layers.core.dropout.Dropout object at 0x0000018938B20700>\n",
      "True\n",
      "<keras.layers.core.dense.Dense object at 0x00000189559175B0>\n",
      "True\n",
      "<keras.layers.core.dropout.Dropout object at 0x0000018947982730>\n",
      "True\n",
      "<keras.layers.core.dense.Dense object at 0x000001893898FB80>\n",
      "True\n",
      "<keras.layers.core.dropout.Dropout object at 0x00000189553AEF10>\n",
      "True\n",
      "<keras.layers.core.dense.Dense object at 0x00000189558EF6A0>\n",
      "True\n",
      "Model: \"sequential_23\"\n",
      "_________________________________________________________________\n",
      " Layer (type)                Output Shape              Param #   \n",
      "=================================================================\n",
      " conv1d_20 (Conv1D)          (None, 640, 32)           1312      \n",
      "                                                                 \n",
      " conv1d_21 (Conv1D)          (None, 621, 32)           20512     \n",
      "                                                                 \n",
      " spatial_dropout1d_10 (Spati  (None, 621, 32)          0         \n",
      " alDropout1D)                                                    \n",
      "                                                                 \n",
      " conv1d_22 (Conv1D)          (None, 616, 32)           6176      \n",
      "                                                                 \n",
      " average_pooling1d_5 (Averag  (None, 308, 32)          0         \n",
      " ePooling1D)                                                     \n",
      "                                                                 \n",
      " conv1d_23 (Conv1D)          (None, 303, 32)           6176      \n",
      "                                                                 \n",
      " spatial_dropout1d_11 (Spati  (None, 303, 32)          0         \n",
      " alDropout1D)                                                    \n",
      "                                                                 \n",
      " flatten_5 (Flatten)         (None, 9696)              0         \n",
      "                                                                 \n",
      " dense_111 (Dense)           (None, 296)               2870312   \n",
      "                                                                 \n",
      " dropout_81 (Dropout)        (None, 296)               0         \n",
      "                                                                 \n",
      " dense_112 (Dense)           (None, 148)               43956     \n",
      "                                                                 \n",
      " dropout_82 (Dropout)        (None, 148)               0         \n",
      "                                                                 \n",
      " dense_113 (Dense)           (None, 74)                11026     \n",
      "                                                                 \n",
      " dropout_83 (Dropout)        (None, 74)                0         \n",
      "                                                                 \n",
      " dense_114 (Dense)           (None, 4)                 300       \n",
      "                                                                 \n",
      "=================================================================\n",
      "Total params: 2,959,770\n",
      "Trainable params: 2,925,594\n",
      "Non-trainable params: 34,176\n",
      "_________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "NewNet = tf.keras.Sequential()\n",
    "for layer in autoencoder.encoder.layers[:-1]:\n",
    "    layer.trainable = False\n",
    "    NewNet.add(layer)\n",
    "drop_rate = 0.5\n",
    "NewNet.add(tf.keras.layers.Dense(296, activation='relu'))\n",
    "NewNet.add(tf.keras.layers.Dropout(drop_rate))\n",
    "NewNet.add(tf.keras.layers.Dense(148, activation='relu'))\n",
    "NewNet.add(tf.keras.layers.Dropout(drop_rate))\n",
    "NewNet.add(tf.keras.layers.Dense(74, activation='relu'))\n",
    "NewNet.add(tf.keras.layers.Dropout(drop_rate))\n",
    "NewNet.add(tf.keras.layers.Dense(4, activation='softmax'))\n",
    "\n",
    "# check trainablitity\n",
    "\n",
    "for layer in NewNet.layers:\n",
    "    print(layer)\n",
    "    print(layer.trainable)\n",
    "\n",
    "NewNet.summary()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 286,
   "metadata": {},
   "outputs": [],
   "source": [
    "learning_rate = 1e-4\n",
    "\n",
    "loss = tf.keras.losses.categorical_crossentropy\n",
    "optimizer = tf.keras.optimizers.Adam(learning_rate=learning_rate)\n",
    "\n",
    "NewNet.compile(loss=loss, optimizer=optimizer, metrics=['accuracy'])\n",
    "\n",
    "# Where to save model\n",
    "modelPath = r'\\models\\autoencoderMlpModel.h5'\n",
    "\n",
    "# build callback list\n",
    "checkpoint = ModelCheckpoint( # set model saving checkpoints\n",
    "    modelPath, # set path to save model weights\n",
    "    monitor='val_loss', # set monitor metrics\n",
    "    verbose=1, # set training verbosity\n",
    "    save_best_only=True, # set if want to save only best weights\n",
    "    save_weights_only=True, # set if you want to save only model weights\n",
    "    mode='auto', # set if save min or max in metrics\n",
    "    save_freq='epoch' # interval between checkpoints\n",
    "    )\n",
    "\n",
    "earlystopping = EarlyStopping(\n",
    "    monitor='val_loss', # set monitor metrics\n",
    "    min_delta=0.00001, # set minimum metrics delta\n",
    "    patience=10, # number of epochs to stop training\n",
    "    restore_best_weights=True, # set if use best weights or last weights\n",
    "    )\n",
    "callbacksList = [checkpoint, earlystopping] # build callbacks list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 287,
   "metadata": {},
   "outputs": [],
   "source": [
    "NewNet.build(input_shape = (None,640,2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 288,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/200\n",
      "90/91 [============================>.] - ETA: 0s - loss: 1.3862 - accuracy: 0.2478\n",
      "Epoch 1: val_loss improved from inf to 1.38630, saving model to C:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\anotherGoodModel.h5\n",
      "91/91 [==============================] - 4s 37ms/step - loss: 1.3862 - accuracy: 0.2467 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 2/200\n",
      "91/91 [==============================] - ETA: 0s - loss: 1.3864 - accuracy: 0.2555\n",
      "Epoch 2: val_loss improved from 1.38630 to 1.38630, saving model to C:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\anotherGoodModel.h5\n",
      "91/91 [==============================] - 3s 34ms/step - loss: 1.3864 - accuracy: 0.2555 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 3/200\n",
      "90/91 [============================>.] - ETA: 0s - loss: 1.3864 - accuracy: 0.2556\n",
      "Epoch 3: val_loss improved from 1.38630 to 1.38630, saving model to C:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\anotherGoodModel.h5\n",
      "91/91 [==============================] - 3s 34ms/step - loss: 1.3864 - accuracy: 0.2555 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 4/200\n",
      "89/91 [============================>.] - ETA: 0s - loss: 1.3865 - accuracy: 0.2652\n",
      "Epoch 4: val_loss did not improve from 1.38630\n",
      "91/91 [==============================] - 3s 33ms/step - loss: 1.3866 - accuracy: 0.2610 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 5/200\n",
      "91/91 [==============================] - ETA: 0s - loss: 1.3869 - accuracy: 0.2401\n",
      "Epoch 5: val_loss did not improve from 1.38630\n",
      "91/91 [==============================] - 3s 33ms/step - loss: 1.3869 - accuracy: 0.2401 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 6/200\n",
      "90/91 [============================>.] - ETA: 0s - loss: 1.3868 - accuracy: 0.2367\n",
      "Epoch 6: val_loss did not improve from 1.38630\n",
      "91/91 [==============================] - 3s 33ms/step - loss: 1.3868 - accuracy: 0.2346 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 7/200\n",
      "89/91 [============================>.] - ETA: 0s - loss: 1.3866 - accuracy: 0.2427\n",
      "Epoch 7: val_loss did not improve from 1.38630\n",
      "91/91 [==============================] - 3s 32ms/step - loss: 1.3866 - accuracy: 0.2456 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 8/200\n",
      "91/91 [==============================] - ETA: 0s - loss: 1.3862 - accuracy: 0.2533\n",
      "Epoch 8: val_loss improved from 1.38630 to 1.38629, saving model to C:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\anotherGoodModel.h5\n",
      "91/91 [==============================] - 3s 32ms/step - loss: 1.3862 - accuracy: 0.2533 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 9/200\n",
      "90/91 [============================>.] - ETA: 0s - loss: 1.3862 - accuracy: 0.2489\n",
      "Epoch 9: val_loss did not improve from 1.38629\n",
      "91/91 [==============================] - 3s 33ms/step - loss: 1.3862 - accuracy: 0.2467 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 10/200\n",
      "89/91 [============================>.] - ETA: 0s - loss: 1.3866 - accuracy: 0.2157\n",
      "Epoch 10: val_loss did not improve from 1.38629\n",
      "91/91 [==============================] - 3s 34ms/step - loss: 1.3866 - accuracy: 0.2181 - val_loss: 1.3863 - val_accuracy: 0.2503\n",
      "Epoch 11/200\n",
      "90/91 [============================>.] - ETA: 0s - loss: 1.3864 - accuracy: 0.2411\n",
      "Epoch 11: val_loss did not improve from 1.38629\n",
      "91/91 [==============================] - 3s 33ms/step - loss: 1.3864 - accuracy: 0.2401 - val_loss: 1.3863 - val_accuracy: 0.2503\n"
     ]
    }
   ],
   "source": [
    "hist = NewNet.fit(x_test_reshaped, y_test_OH, epochs=100, batch_size=10,\n",
    "                    validation_data=(x_valid_reshaped, y_valid_OH), callbacks=callbacksList)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 274,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x1893b6474f0>"
      ]
     },
     "execution_count": 274,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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9XKvX+3a7vmddpr7PEZEuE6MeT97U6e69zouzr0P06e7uGlT91n8/nsXN2wIO3e6z9ppp7lkmZLiBi457TT3/7djh3v+p53mjr19u3t9evWCmjXd81uyxH12qld3z2/pUle2KlVg69YQ1i4cR8g93ZmVfjnrPlnI6rSGdO3qknJyMmzc6D47ISEu3roV2rVzsTfBJyS493j7dlfG1q1dvGOHe44nnugSbUqK+39s1szFO3e617phQ7f+rl3us1avnu/9OkZhIjI/T/yWqr7lud8YyDs1QxJw8lHbH15HVbNFJBWI8Syfc9S2jT33i9pn4KlqubpVq1ZNj8WMGarNmqnWr6/6z3+qPv64aqtWqieeqDp2rOqECaoJCaqdOqnOmqU6d65qx46qvXurJiWp7trl4osv9u0zIUF10CBf3LKl6hVX+OKmTVWvvdYX16+veuONvrhWLdW//90XV6umevfdvjgszJVVVTUnRxVU//UvFx886OInn3Tx3r0ufv55F+/Y4eJXX3VxUpKL33rLxWvXunjcOBevWOHijz5y8aJFLp4yxcW//+7ir75y8f/+5+LvvnPxDz+4eNYsF3/9tYvnzHHx55+7eOFCF0+a5OKlS1383/+6eM0aF48d6+KNG138+usu3rbNxS++6OLdu1381FMu3r/fxY8/7uKsLBc/9JCqiO+1vece1SpVfPHo0arR0b745ptVY2N98YgRqo0b++Krr1Zt3twXX365aps2vviSS9znxev881W7dfPFffqo9urli3v3Vj3rLF/co4dqv36+uHPnIz97bdse+dlr0UL1yit9sfezd+iQew1r13b7GzNG9dFHVSMi3Gf/lFNU4+Lca5XfLTxctUkTd791a9WRI1Xvv9/FV12l+ttvqosXH/nZ277dxa+95uLNm1389tsuTkw88rO3fLmLJ050cUGfvWnTXHz0Z+/774/ts7dsmYuP/uy9846Lt377p2q1arq1RS8NJ6PIz156uouP/uw9+GDxP3t16/rioz97xwpI1wK+V4FBwDt54quBV49aZynQJE+8FogFXgWuyrN8rGd//uxzAxBbULlK4lZpLiF47TV4+GH3iygjw/1CPVZVqrhf0RERrlYRFeXikBD3t1Yt9zcnx/1SrFPHxRkZbt26dV2clubWrV/fxXv2uF+iDRq4Y+zY4X69NWzojrthg1u/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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig,ax=plt.subplots()\n",
    "ax.plot(hist.history['accuracy'], color = 'b')\n",
    "ax.plot(hist.history['val_accuracy'], linestyle=':', color = 'b')\n",
    "ax.set_ylabel(\"Accuracy\", color = 'b')\n",
    "ax.set_ylim([0,1])\n",
    "ax2=ax.twinx()\n",
    "ax2.plot(hist.history['loss'],  color = 'r')\n",
    "ax2.plot(hist.history['val_loss'], linestyle=':',  color = 'r')\n",
    "ax2.set_ylabel(\"Loss (cross-entropy)\",  color = 'r')\n",
    "fig.legend(['accuracy','val_accuracy','loss','val_loss'])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Transfer learning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 289,
   "metadata": {},
   "outputs": [],
   "source": [
    "trainedModel_loaded = tf.keras.models.load_model(filepath + '\\\\models\\\\PreTrainedModel')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Replace the output layer for 4 rather than 5 classes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 290,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"sequential_24\"\n",
      "_________________________________________________________________\n",
      " Layer (type)                Output Shape              Param #   \n",
      "=================================================================\n",
      " conv1d (Conv1D)             (None, 640, 32)           1312      \n",
      "                                                                 \n",
      " batch_normalization (BatchN  (None, 640, 32)          128       \n",
      " ormalization)                                                   \n",
      "                                                                 \n",
      " conv1d_1 (Conv1D)           (None, 621, 32)           20512     \n",
      "                                                                 \n",
      " batch_normalization_1 (Batc  (None, 621, 32)          128       \n",
      " hNormalization)                                                 \n",
      "                                                                 \n",
      " spatial_dropout1d (SpatialD  (None, 621, 32)          0         \n",
      " ropout1D)                                                       \n",
      "                                                                 \n",
      " conv1d_2 (Conv1D)           (None, 616, 32)           6176      \n",
      "                                                                 \n",
      " average_pooling1d (AverageP  (None, 308, 32)          0         \n",
      " ooling1D)                                                       \n",
      "                                                                 \n",
      " conv1d_3 (Conv1D)           (None, 303, 32)           6176      \n",
      "                                                                 \n",
      " spatial_dropout1d_1 (Spatia  (None, 303, 32)          0         \n",
      " lDropout1D)                                                     \n",
      "                                                                 \n",
      " flatten (Flatten)           (None, 9696)              0         \n",
      "                                                                 \n",
      " dense_115 (Dense)           (None, 296)               2870312   \n",
      "                                                                 \n",
      " dropout_84 (Dropout)        (None, 296)               0         \n",
      "                                                                 \n",
      " dense_116 (Dense)           (None, 148)               43956     \n",
      "                                                                 \n",
      " dropout_85 (Dropout)        (None, 148)               0         \n",
      "                                                                 \n",
      " dense_117 (Dense)           (None, 74)                11026     \n",
      "                                                                 \n",
      " dropout_86 (Dropout)        (None, 74)                0         \n",
      "                                                                 \n",
      " dense_118 (Dense)           (None, 4)                 300       \n",
      "                                                                 \n",
      "=================================================================\n",
      "Total params: 2,960,026\n",
      "Trainable params: 2,959,898\n",
      "Non-trainable params: 128\n",
      "_________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "trainedModel_newLayers = tf.keras.Sequential()\n",
    "for layer in trainedModel_loaded.layers[:10]: # go through until flatten layer\n",
    "    trainedModel_newLayers.add(layer)\n",
    "\n",
    "trainedModel_newLayers.add(tf.keras.layers.Dense(296, activation='relu'))\n",
    "trainedModel_newLayers.add(tf.keras.layers.Dropout(0.5))\n",
    "trainedModel_newLayers.add(tf.keras.layers.Dense(148, activation='relu'))\n",
    "trainedModel_newLayers.add(tf.keras.layers.Dropout(0.5))\n",
    "trainedModel_newLayers.add(tf.keras.layers.Dense(74, activation='relu'))\n",
    "trainedModel_newLayers.add(tf.keras.layers.Dropout(0.5))\n",
    "trainedModel_newLayers.add(tf.keras.layers.Dense(4, activation='softmax'))\n",
    "\n",
    "trainedModel_newLayers.summary()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Freeze the first few convolutional layers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 291,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<keras.layers.convolutional.Conv1D object at 0x0000018955C86760>\n",
      "Trainable? False\n",
      "<keras.layers.normalization.batch_normalization.BatchNormalization object at 0x00000189566E4220>\n",
      "Trainable? False\n",
      "<keras.layers.convolutional.Conv1D object at 0x00000189566E4820>\n",
      "Trainable? False\n",
      "<keras.layers.normalization.batch_normalization.BatchNormalization object at 0x00000189566EE430>\n",
      "Trainable? False\n",
      "<keras.layers.core.spatial_dropout.SpatialDropout1D object at 0x00000189566EEA30>\n",
      "Trainable? False\n",
      "<keras.layers.convolutional.Conv1D object at 0x00000189566F42B0>\n",
      "Trainable? False\n",
      "<keras.layers.pooling.AveragePooling1D object at 0x00000189566F4A30>\n",
      "Trainable? False\n",
      "<keras.layers.convolutional.Conv1D object at 0x00000189566F4C70>\n",
      "Trainable? False\n",
      "<keras.layers.core.spatial_dropout.SpatialDropout1D object at 0x00000189566FB490>\n",
      "Trainable? False\n",
      "<keras.layers.core.flatten.Flatten object at 0x00000189566FB790>\n",
      "Trainable? False\n",
      "<keras.layers.core.dense.Dense object at 0x0000018955CE8FD0>\n",
      "Trainable? True\n",
      "<keras.layers.core.dropout.Dropout object at 0x0000018955D03BB0>\n",
      "Trainable? True\n",
      "<keras.layers.core.dense.Dense object at 0x0000018958BB0F70>\n",
      "Trainable? True\n",
      "<keras.layers.core.dropout.Dropout object at 0x0000018958BCAA00>\n",
      "Trainable? True\n",
      "<keras.layers.core.dense.Dense object at 0x0000018958BCADC0>\n",
      "Trainable? True\n",
      "<keras.layers.core.dropout.Dropout object at 0x0000018958BAEE80>\n",
      "Trainable? True\n",
      "<keras.layers.core.dense.Dense object at 0x0000018958BD2F10>\n",
      "Trainable? True\n",
      "Model: \"sequential_24\"\n",
      "_________________________________________________________________\n",
      " Layer (type)                Output Shape              Param #   \n",
      "=================================================================\n",
      " conv1d (Conv1D)             (None, 640, 32)           1312      \n",
      "                                                                 \n",
      " batch_normalization (BatchN  (None, 640, 32)          128       \n",
      " ormalization)                                                   \n",
      "                                                                 \n",
      " conv1d_1 (Conv1D)           (None, 621, 32)           20512     \n",
      "                                                                 \n",
      " batch_normalization_1 (Batc  (None, 621, 32)          128       \n",
      " hNormalization)                                                 \n",
      "                                                                 \n",
      " spatial_dropout1d (SpatialD  (None, 621, 32)          0         \n",
      " ropout1D)                                                       \n",
      "                                                                 \n",
      " conv1d_2 (Conv1D)           (None, 616, 32)           6176      \n",
      "                                                                 \n",
      " average_pooling1d (AverageP  (None, 308, 32)          0         \n",
      " ooling1D)                                                       \n",
      "                                                                 \n",
      " conv1d_3 (Conv1D)           (None, 303, 32)           6176      \n",
      "                                                                 \n",
      " spatial_dropout1d_1 (Spatia  (None, 303, 32)          0         \n",
      " lDropout1D)                                                     \n",
      "                                                                 \n",
      " flatten (Flatten)           (None, 9696)              0         \n",
      "                                                                 \n",
      " dense_115 (Dense)           (None, 296)               2870312   \n",
      "                                                                 \n",
      " dropout_84 (Dropout)        (None, 296)               0         \n",
      "                                                                 \n",
      " dense_116 (Dense)           (None, 148)               43956     \n",
      "                                                                 \n",
      " dropout_85 (Dropout)        (None, 148)               0         \n",
      "                                                                 \n",
      " dense_117 (Dense)           (None, 74)                11026     \n",
      "                                                                 \n",
      " dropout_86 (Dropout)        (None, 74)                0         \n",
      "                                                                 \n",
      " dense_118 (Dense)           (None, 4)                 300       \n",
      "                                                                 \n",
      "=================================================================\n",
      "Total params: 2,960,026\n",
      "Trainable params: 2,925,594\n",
      "Non-trainable params: 34,432\n",
      "_________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "for i in range(10):\n",
    "    trainedModel_newLayers.layers[i].trainable = False\n",
    "\n",
    "for layer in trainedModel_newLayers.layers:\n",
    "    print(layer)\n",
    "    print('Trainable? ' + str(layer.trainable))\n",
    "\n",
    "trainedModel_newLayers.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 292,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Saving to: c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "Epoch 1/100\n",
      "77/78 [============================>.] - ETA: 0s - loss: 1.4206 - accuracy: 0.2221\n",
      "Epoch 1: val_loss improved from inf to 1.38622, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 4s 44ms/step - loss: 1.4198 - accuracy: 0.2227 - val_loss: 1.3862 - val_accuracy: 0.2500\n",
      "Epoch 2/100\n",
      "77/78 [============================>.] - ETA: 0s - loss: 1.4004 - accuracy: 0.2545\n",
      "Epoch 2: val_loss improved from 1.38622 to 1.38435, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 38ms/step - loss: 1.4004 - accuracy: 0.2535 - val_loss: 1.3844 - val_accuracy: 0.2919\n",
      "Epoch 3/100\n",
      "77/78 [============================>.] - ETA: 0s - loss: 1.3861 - accuracy: 0.2831\n",
      "Epoch 3: val_loss improved from 1.38435 to 1.38280, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 41ms/step - loss: 1.3861 - accuracy: 0.2844 - val_loss: 1.3828 - val_accuracy: 0.2665\n",
      "Epoch 4/100\n",
      "77/78 [============================>.] - ETA: 0s - loss: 1.3900 - accuracy: 0.2935\n",
      "Epoch 4: val_loss did not improve from 1.38280\n",
      "78/78 [==============================] - 3s 38ms/step - loss: 1.3899 - accuracy: 0.2934 - val_loss: 1.3833 - val_accuracy: 0.2643\n",
      "Epoch 5/100\n",
      "77/78 [============================>.] - ETA: 0s - loss: 1.3878 - accuracy: 0.2649\n",
      "Epoch 5: val_loss did not improve from 1.38280\n",
      "78/78 [==============================] - 3s 36ms/step - loss: 1.3869 - accuracy: 0.2651 - val_loss: 1.3830 - val_accuracy: 0.2786\n",
      "Epoch 6/100\n",
      "76/78 [============================>.] - ETA: 0s - loss: 1.3808 - accuracy: 0.2829\n",
      "Epoch 6: val_loss improved from 1.38280 to 1.38062, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 38ms/step - loss: 1.3823 - accuracy: 0.2780 - val_loss: 1.3806 - val_accuracy: 0.2930\n",
      "Epoch 7/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.3724 - accuracy: 0.2844\n",
      "Epoch 7: val_loss improved from 1.38062 to 1.38055, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 37ms/step - loss: 1.3724 - accuracy: 0.2844 - val_loss: 1.3806 - val_accuracy: 0.2930\n",
      "Epoch 8/100\n",
      "76/78 [============================>.] - ETA: 0s - loss: 1.3554 - accuracy: 0.3329\n",
      "Epoch 8: val_loss improved from 1.38055 to 1.37891, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 36ms/step - loss: 1.3564 - accuracy: 0.3308 - val_loss: 1.3789 - val_accuracy: 0.2852\n",
      "Epoch 9/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.3635 - accuracy: 0.3050\n",
      "Epoch 9: val_loss improved from 1.37891 to 1.37888, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 37ms/step - loss: 1.3635 - accuracy: 0.3050 - val_loss: 1.3789 - val_accuracy: 0.2819\n",
      "Epoch 10/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.3441 - accuracy: 0.3282\n",
      "Epoch 10: val_loss improved from 1.37888 to 1.37773, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 38ms/step - loss: 1.3441 - accuracy: 0.3282 - val_loss: 1.3777 - val_accuracy: 0.2985\n",
      "Epoch 11/100\n",
      "77/78 [============================>.] - ETA: 0s - loss: 1.3513 - accuracy: 0.3325\n",
      "Epoch 11: val_loss did not improve from 1.37773\n",
      "78/78 [==============================] - 3s 38ms/step - loss: 1.3504 - accuracy: 0.3346 - val_loss: 1.3782 - val_accuracy: 0.2819\n",
      "Epoch 12/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.3483 - accuracy: 0.3037\n",
      "Epoch 12: val_loss improved from 1.37773 to 1.37644, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 36ms/step - loss: 1.3483 - accuracy: 0.3037 - val_loss: 1.3764 - val_accuracy: 0.2830\n",
      "Epoch 13/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.3275 - accuracy: 0.3629\n",
      "Epoch 13: val_loss improved from 1.37644 to 1.37456, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 39ms/step - loss: 1.3275 - accuracy: 0.3629 - val_loss: 1.3746 - val_accuracy: 0.2874\n",
      "Epoch 14/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.3306 - accuracy: 0.3475\n",
      "Epoch 14: val_loss improved from 1.37456 to 1.37436, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 39ms/step - loss: 1.3306 - accuracy: 0.3475 - val_loss: 1.3744 - val_accuracy: 0.3018\n",
      "Epoch 15/100\n",
      "77/78 [============================>.] - ETA: 0s - loss: 1.2883 - accuracy: 0.3987\n",
      "Epoch 15: val_loss improved from 1.37436 to 1.37297, saving model to c:\\Users\\james\\OneDrive\\GradSchool\\Spring 2022\\tunedMode.h5\n",
      "78/78 [==============================] - 3s 38ms/step - loss: 1.2886 - accuracy: 0.3990 - val_loss: 1.3730 - val_accuracy: 0.2786\n",
      "Epoch 16/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.2779 - accuracy: 0.4106\n",
      "Epoch 16: val_loss did not improve from 1.37297\n",
      "78/78 [==============================] - 3s 37ms/step - loss: 1.2779 - accuracy: 0.4106 - val_loss: 1.3776 - val_accuracy: 0.2919\n",
      "Epoch 17/100\n",
      "77/78 [============================>.] - ETA: 0s - loss: 1.2728 - accuracy: 0.4169\n",
      "Epoch 17: val_loss did not improve from 1.37297\n",
      "78/78 [==============================] - 3s 38ms/step - loss: 1.2719 - accuracy: 0.4196 - val_loss: 1.3787 - val_accuracy: 0.2863\n",
      "Epoch 18/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.2644 - accuracy: 0.4440\n",
      "Epoch 18: val_loss did not improve from 1.37297\n",
      "78/78 [==============================] - 3s 36ms/step - loss: 1.2644 - accuracy: 0.4440 - val_loss: 1.3781 - val_accuracy: 0.2896\n",
      "Epoch 19/100\n",
      "78/78 [==============================] - ETA: 0s - loss: 1.2564 - accuracy: 0.4440\n",
      "Epoch 19: val_loss did not improve from 1.37297\n",
      "78/78 [==============================] - 3s 38ms/step - loss: 1.2564 - accuracy: 0.4440 - val_loss: 1.3815 - val_accuracy: 0.2863\n"
     ]
    }
   ],
   "source": [
    "learning_rate = 1e-4\n",
    "\n",
    "loss = tf.keras.losses.categorical_crossentropy\n",
    "optimizer = tf.keras.optimizers.Adam(learning_rate=learning_rate)\n",
    "modelPath = os.path.join(os.getcwd(), 'tunedMode.h5')\n",
    "print('Saving to: ' + modelPath)\n",
    "\n",
    "trainedModel_newLayers.compile(loss=loss, optimizer=optimizer, metrics=['accuracy'])\n",
    "\n",
    "checkpoint = ModelCheckpoint( # set model saving checkpoints\n",
    "    modelPath, # set path to save model weights\n",
    "    monitor='val_loss', # set monitor metrics\n",
    "    verbose=1, # set training verbosity\n",
    "    save_best_only=True, # set if want to save only best weights\n",
    "    save_weights_only=True, # set if you want to save only model weights\n",
    "    mode='auto', # set if save min or max in metrics\n",
    "    save_freq=\"epoch\"  # interval between checkpoints\n",
    "    )\n",
    "\n",
    "earlystopping = EarlyStopping(\n",
    "    monitor='val_loss', # set monitor metrics\n",
    "    min_delta=0.00001, # set minimum metrics delta\n",
    "    patience=4, # number of epochs to stop training\n",
    "    restore_best_weights=True, # set if use best weights or last weights\n",
    "    )\n",
    "callbacksList = [checkpoint, earlystopping] # build callbacks list\n",
    "\n",
    "hist = trainedModel_newLayers.fit(x_train_reshaped, y_train_OH_smote, epochs=100, batch_size=10,\n",
    "                validation_data=(x_test_reshaped, y_test_OH), callbacks=callbacksList) #32"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 294,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x1895a2c5be0>"
      ]
     },
     "execution_count": 294,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAa0AAAEWCAYAAADVW8iBAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8rg+JYAAAACXBIWXMAAAsTAAALEwEAmpwYAABWPUlEQVR4nO2dd3hU1dOA30lC79KboNJ7EyvYewFEBUSxI/aK5bP3+rM3itgLiqA0xQaChd6rgNJD7z1lvj9m1w2YsgnZ7CaZ93nuk517z7l39mb3zs45c2ZEVXEcx3Gc/EBctBVwHMdxnHBxo+U4juPkG9xoOY7jOPkGN1qO4zhOviEh2go4juPEAtOmTauSkJAwEGiG/6CPNqnA3OTk5Ovatm27Pu0BN1qO4zhAQkLCwGrVqjWuXLnylri4OA+rjiKpqamyYcOGJmvXrh0IXJj2mP+acBzHMZpVrlx5uxus6BMXF6eVK1fehnm9Bx6Lgj6O4zixSJwbrNgh8L/4j41yo+U4juPkG9xoOY7jFDKSkpKirUKOcaPlOI4TQ5x++ulHNW3atHG9evWavvTSS5UAhgwZUrZJkyaNGzZs2OS4445rALBt27a4iy++uG6DBg2aNGjQoMkHH3xQHqBkyZKtg+d6//33K3Tt2rUuQNeuXetedtllh7do0aLRjTfeWGvs2LElW7Vq1ahx48ZNWrdu3WjWrFnFAJKTk+ndu3et+vXrN23QoEGTp59+usrw4cPLnH766UcFzzts2LCyZ5xxxlFEAY8edBzHOYhrrqH23LmUzM1zNmvG7kGDWJlVu08//XRZ1apVU3bu3CmtW7du0q1bt6233HJL3XHjxi1s1KjR/nXr1sUD3H///dXLli2b8tdff80H2LBhQ3xW505MTCw6ffr0hQkJCWzevDluypQpC4sUKcI333xT5t577601ZsyYpf/73/8qr1ixouj8+fPnFSlShHXr1sVXrlw55fbbbz98zZo1CTVq1EgeNGhQxauvvnrjod+V7ONGy3EcJ4Z4/vnnq44aNao8wNq1a4u8/vrrldu3b7+jUaNG+wGqVq2aAjB+/PiyX3zxxd/BfpUrV07J6twXXXTRloQEe+xv3rw5vlu3bkcsW7asuIhoUlKSAPzyyy9l+/Tps6FIkSKkvd6ll166acCAAYfdfPPNm6ZPn1566NCh/+TqGw8TN1qO4zgHEY5HFAlGjhxZ5tdffy0zderUhWXKlElt3759w9atW+9etGhR8XDPISL/vt6zZ4+kPVa6dOnU4Ov77ruv5kknnbTjxx9/XLpo0aKip556asPMznvjjTduOu+88+oVL15cL7jggi1Bo5bX+JyW4zhOjLB169b4cuXKpZQpUyZ1xowZxWfNmlVq7969cZMnTy6zcOHCogDB4cGTTjpp+yuvvFIl2Dc4PFixYsWk6dOnF09JSeHbb7+tkNG1tm/fHl+rVq39AP369asU3H/aaadt79evX6VgsEbwenXr1k2qWrVq0v/+97/qvXv3jsrQILjRchzHiRm6du26LTk5WY488simffv2rdmyZctdVapUSX799deXdenSpV7Dhg2bdOnS5UiAZ599NnHr1q3x9evXb9qwYcMmo0ePLgPw+OOPr+7UqVO9Nm3aNKpatWqGYYL33Xff2scee6xW48aNmyQnJ/+7/84779xQq1at/Y0aNWrasGHDJu+9995hwWPdu3ffVL169f1t2rTZG8HbkCniRSAdx3Fg1qxZy1q2bBk1DyI/0KtXr8Nbt269+84778yT+zRr1qxKLVu2rJt2n89pOY7jOFnStGnTxiVKlEjt169fVOb7grjRchzHcbJk3rx5C6KtA/icluM4jpOPcKPlOI7j5BvcaDmO4zj5BjdajuM4Tr7BjZbjOI6Tb3Cj5TiOk09Jm9G9sOBGy3Ecxzkk8rI+lxstx3GcdGjfnoavv05FgH37kPbtafj22xwGsGMHce3b03DAACoAbNpEfPv2NPzwQ8oDJCaS0L49DT/7jHIAK1aEtyb2pptuqvnss89WDsp33XVXjXvvvbf6cccd16BJkyaNGzRo0OSTTz4pH865tm3bFpdRvzfffLNigwYNmjRs2LBJ586djwBYuXJlwhlnnHFUw4YNmzRs2LDJjz/+WGrRokVF69ev3zTY75FHHql611131bD7077hNddcU7tZs2aNn3rqqaqfffZZuRYtWjRq3Lhxk+OPP77BypUrE4J6HFz369VXX614zTXX1A6e93//+1+la6+99l85M3xxseM4TozQs2fPzXfcccfhDzzwwAaAb7/9tsKYMWP+uv/++9cddthhqYmJiQnHHHNMo8suu2xrXFzmPkfJkiVTR40ateTgftOnTy/+0ksvVf/zzz8XVq9ePTmYELdPnz6H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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig,ax=plt.subplots()\n",
    "ax.plot(hist.history['accuracy'], color = 'b')\n",
    "ax.plot(hist.history['val_accuracy'], linestyle=':', color = 'b')\n",
    "ax.set_ylabel(\"Accuracy\", color = 'b')\n",
    "ax.set_ylim([0,1])\n",
    "ax2=ax.twinx()\n",
    "ax2.plot(hist.history['loss'],  color = 'r')\n",
    "ax2.plot(hist.history['val_loss'], linestyle=':',  color = 'r')\n",
    "ax2.set_ylabel(\"Loss (cross-entropy)\",  color = 'r')\n",
    "fig.legend(['accuracy','val_accuracy','loss','val_loss'])\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Evaluate final model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 301,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "29/29 [==============================] - 1s 28ms/step - loss: 1.3674 - accuracy: 0.3120\n",
      "\n",
      "Accuracy: 0.31201764941215515\n",
      "\n",
      "Loss:  1.3674137592315674\n",
      "\n",
      " Cohen kappa \n",
      "\n",
      " 0.08269353262375823\n",
      "\n",
      " Classification report \n",
      "\n",
      "               precision    recall  f1-score   support\n",
      "\n",
      "       Right       0.29      0.39      0.33       227\n",
      "        Left       0.31      0.31      0.31       226\n",
      "        Rest       0.28      0.18      0.22       227\n",
      "      tongue       0.37      0.37      0.37       227\n",
      "\n",
      "    accuracy                           0.31       907\n",
      "   macro avg       0.31      0.31      0.31       907\n",
      "weighted avg       0.31      0.31      0.31       907\n",
      "\n",
      "\n",
      " Confusion matrix \n",
      "\n",
      " [[88 61 38 40]\n",
      " [71 70 35 50]\n",
      " [89 43 40 55]\n",
      " [59 55 28 85]]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 301,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "testLoss, testAcc = trainedModel_newLayers.evaluate(x_valid_reshaped, y_valid_OH)\n",
    "print('\\nAccuracy:', testAcc)\n",
    "print('\\nLoss: ', testLoss)\n",
    "\n",
    "from sklearn.metrics import classification_report, confusion_matrix, cohen_kappa_score\n",
    "yPred = trainedModel_newLayers.predict(x_valid_reshaped)\n",
    "\n",
    "# convert from one hot encode in string\n",
    "yTestClass = np.argmax(y_valid_OH, axis=1)\n",
    "yPredClass = np.argmax(yPred,axis=1)\n",
    "\n",
    "print('\\n Cohen kappa \\n\\n',\n",
    "  cohen_kappa_score(\n",
    "      yTestClass,\n",
    "      yPredClass\n",
    "      )\n",
    "  )\n",
    "\n",
    "print('\\n Classification report \\n\\n',\n",
    "  classification_report(\n",
    "      yTestClass,\n",
    "      yPredClass,\n",
    "       target_names=[\"Right\", \"Left\", \"Rest\", \"tongue\"]\n",
    "      )\n",
    "  )\n",
    "\n",
    "print('\\n Confusion matrix \\n\\n',\n",
    "  confusion_matrix(\n",
    "      yTestClass,\n",
    "      yPredClass,\n",
    "      )\n",
    "  )\n",
    "\n",
    "import seaborn as sns\n",
    "sns.heatmap(confusion_matrix(\n",
    "      yTestClass,\n",
    "      yPredClass,\n",
    "      ))"
   ]
  }
 ],
 "metadata": {
  "interpreter": {
   "hash": "97feb688b70790b3a36568db4150e7c0b6184ca81aa48ab1cffefce025dbdfee"
  },
  "kernelspec": {
   "display_name": "Python 3.9.12 64-bit (windows store)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  },
  "orig_nbformat": 4
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
